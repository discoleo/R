

### Method: Polynomial Construction

perm = list(1:5, c(2,1,5,3,4), c(1,2,4,5,3),
	c(1,5,3,2,4), c(1,2,3,5,4), c(1,2,5,3,4));

r0 = roots(c(1,0,0,-3,-1,-2));
E2a = sapply(perm, \(id) { r = r0[id]; E2a = sum(r * r[c(2:5, 1)]); })
E2a = c(E2a, - E2a); poly.calc0(E2a, digits = 6)

### Case: S = 0, E3 != 0

### r0 = ...
# c(1,0,0,+/-1,1,-1)
x^12 - 10*x^10 + 105*x^8 - 342*x^6 + 1310*x^4 - 4776*x^2 + 841
x^12 - 10*x^10 + 5*x^8 + 58*x^6 + 310*x^4 - 3692*x^2 + 441
# c(1,0,0,+/-1,-1,-1)
x^12 + 10*x^10 + 105*x^8 + 338*x^6 + 1290*x^4 - 1364*x^2 + 961
x^12 + 10*x^10 + 5*x^8 - 62*x^6 + 290*x^4 - 2680*x^2 + 361
# c(1,0,0,+/-1,1,1)
x^12 - 10*x^10 + 5*x^8 + 58*x^6 + 310*x^4 - 3692*x^2 + 441
x^12 - 10*x^10 + 105*x^8 - 342*x^6 + 1310*x^4 - 4776*x^2 + 841

# c(1,0,0,+/-2,1,-1));
x^12 - 10*x^10 + 155*x^8 - 572*x^6 + 3835*x^4 - 6623*x^2 + 1521
x^12 - 10*x^10 - 45*x^8 + 228*x^6 + 1835*x^4 - 7935*x^2 + 3721

# c(1,0,0,+/-3,1,-1)
x^12 - 10*x^10 + 205*x^8 - 902*x^6 + 8110*x^4 - 180*x^2 + 1
x^12 - 10*x^10 - 95*x^8 + 298*x^6 + 5110*x^4 - 24768*x^2 + 22801

# c(1,0,0,+/-1,2,-1)
x^12 - 20*x^10 + 270*x^8 - 1522*x^6 + 5445*x^4 - 13271*x^2 + 7921
x^12 - 20*x^10 + 170*x^8 - 722*x^6 + 1445*x^4 - 3787*x^2 + 121
# c(1,0,0,+/-2,2,-1)
x^12 - 20*x^10 + 320*x^8 - 1952*x^6 + 9620*x^4 - 22453*x^2 + 15376
x^12 - 20*x^10 + 120*x^8 - 352*x^6 + 1620*x^4 - 6965*x^2 + 5776


### Solve:
x0 = c(1,-1,2,-2,3,-3); # for Vandermonde

# v0 = c(1310-1330, 310-290, 3835-3875, 1835-1795, 8110-8170, 5110-5050)
v0 = c(-4776+4726, -3692+3742, -6623+6523, -7935+8035, -180+30, -24768+24918)
solve(vandermonde(x0), v0)

# p0 = as.pm(...) # THE MONSTER
repl = \(E5 = -1) replace.pm(p0, c(S=0, E5=E5)) |> replace.pm(as.pm("-E11a"), "E11b");
repl() |> replace.pm(c(E3=1, E4=1)) |> print.pm(lead="E11a")
