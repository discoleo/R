########################
###
### Leonard Mada
### [the one and only]
###
### Polynomial Systems: S3
### Hetero-Symmetric Differences
### == Derivation of Formulas ==
###
### draft v.0.1e-branch


####################
### Introduction ###

# - this file contains the derivation of formulas for:
#   Poly.System.Hetero.Symmetric.S3.Diff.R
# - see further details in that file;


####################

###############
### History ###
###############

### draft v.0.1d - v.0.1e:
# - [started] x^3 - x^2*y + b*z = R;
# - various cleanup;
### draft v.0.1c - v.0.1c-fix:
# - system:
#   x^3 + y^3 - z^3 + b*x = R; [minor sign fix]
### draft v.0.1b:
# - system:
#   x^2 - y^2 + b[1]*x*y*(x+y+z) = R;
### draft v.0.1a:
# - moved specific derivations from
#   Poly.System.Hetero.Symmetric.S3.R
#   to this file;
# - systems:
#   x^n - y^n + b*x*y = R;
#   [cases: n = 2 and n = 3]


####################
####################

### Helper Hunctions

source("Polynomials.Helper.R")
source("Polynomials.Helper.EP.R")


# library(polynom)
# library(pracma)

# the functions are in the file:
# Polynomials.Helper.R

##########################


##########################
### Difference Types   ###
##########################

# quasi-[Negative Correlations]

### A. Trivial:
x^n - y^n + b*x*y = R
y^n - z^n + b*y*z = R
z^n - x^n + b*z*x = R


### B. Non-Trivial
# x^n - Mixed Monomial[Order n] + P(x,y,z) = R;

# - are special cases for more generic systems;
# - these special cases behave differently than the generic system;


###############

###############
### Order 2 ###
###############

### Solution:

### Case 1:
det = sqrt(R[1]/b[1])
x = y = z = c(det, -det)

### Case 2:
# (x, y, z) distinct;

### Eq 1:
# Sum =>
b*E2 - 3*R # = 0
E2 = 3*R[1] / b[1];

### Eq 2:
# Sum(z^2*...) =>
# b*x*y*z*S = R*(x^2+y^2+z^2)
b*E3*S - R*(S^2 - 2*E2) # = 0
#
b*E3*S = R*(S^2 - 2*E2)
b*E3*S = R*(S^2 - 6*R / b)

### Eq 3: Helper
# H3a: Sum(z*...) =>
E21b - E21a + 3*b*E3 - R*S # = 0

# H3b: Sum(x*...) =>
(x^3 + y^3 + z^3) - E21b + b*E21a - R*S # = 0
S^3 - 3*E2*S + 3*E3 - E21b + b*E21a - R*S # = 0
# + Eq H3a:
S^3 - 3*E2*S + 3*(b+1)*E3 + (b - 1)*E21a - 2*R*S # = 0
# Note: for b != 1 => E21a;
# (b-1)*(E21a + E21b) =>
(b-1)*(E21b + E21a) + 3*b*(b-1)*E3 - (b-1)*R*S +
	+ 2*(S^3 - 3*E2*S + 3*(b+1)*E3 - 2*R*S) # = 0

### Eq 3:
(b-7)*E2*S + 3*(b^2 + 3)*E3 - (b + 3)*R*S + 2*S^3 # = 0

# Special Case: b = 1:
# - but the general formula works as well;
S^3 - 3*E2*S + 6*E3 - 2*R*S # = 0
# =>
S^4 - 3*E2*S^2 + 6*E3*S - 2*R*S^2 # = 0 [b == 1]
S^4 - 3*E2*S^2 + 6*R*(S^2 - 2*E2) - 2*R*S^2 # = 0
S^4 - (3*E2 - 4*R)*S^2 - 12*R*E2 # = 0

# =>
2*b^2*S^4 + 3*(b-7)*b*R*S^2 + 3*(b^2 + 3)*R*(b*S^2 - 6*R) - b^2*(b + 3)*R*S^2 # = 0
b^2*S^4 + (b^3 - 6*b)*R*S^2 - 9*(b^2 + 3)*R^2 # = 0

### Eq S: P[2] * P[2]
(b*S^2 + R*(b^2 + 3)) * (b*S^2 - 9*R)

### Extension A1: pow 1:
(b[1]*S^2 + 9*b[2]*S - 9*R) * (b[1]*S^2 - b[2]*(b[1]^2 + 3)*S + (b[1]^2 + 3)*R)
### Extension A1: pow 2:
b1 = b[1]; b2 = b[2]; b3 = b[3];
((b1 + 9*b3)*S^2 + 9*b2*S - 9*R) * ((b1 - b3*(b1^2 + 3))*S^2 - b2*(b1^2 + 3)*S + (b1^2 + 3)*R)


### Debug:
# Special/Degenerate Case:
R = 1; b = 1;
x =  1.6510934088i
y = -1.2738905550i
z = -2.3772028539i

#
R = 2; b = 3;
x =  3.1777090299530i
y = -1.1341112221540i
z =  0.7848293169472i
#
S = x+y+z; E3 = x*y*z; E2 = x*y + x*z + y*z;
n = 2;
E21a = x^n*y + y^n*z + z^n*x;
E21b = x*y^n + y*z^n + z*x^n;

### Test
x^2 - y^2 + b[1]*x*y # - R
y^2 - z^2 + b[1]*y*z # - R
z^2 - x^2 + b[1]*x*z # - R


### [old] Eq 3:
### Sum(x*y*...) =>
(x^3*y - x*y^3 - x^3*z + x*z^3 + y^3*z - y*z^3) + b*(x^2*y^2 + x^2*z^2 + y^2*z^2) - R*E2 # = 0
E2*(S^2 - 2*E2) - E3*S - 2*(x*y^3 + x^3*z + y*z^3) + b*(E2^2 - 2*E3*S) - R*E2 # = 0
2*(x*y^3 + x^3*z + y*z^3) - E2*S^2 + 2*b*E3*S + E3*S + (2-b)*E2^2 + R*E2 # = 0
2*(x*y^3 + x^3*z + y*z^3) - E2*S^2 + 2*(R*S^2 - 2*R*E2) + E3*S + (2-b)*E2^2 + R*E2 # = 0
2*b*(x*y^3 + x^3*z + y*z^3) - b*E2*S^2 + 2*b*R*S^2 - 4*R*b*E2 + b*E3*S + (2-b)*b*E2^2 + R*b*E2 # = 0
b^2*(x*y^3 + x^3*z + y*z^3) + b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2 # = 0
### Eq 1: b^2*(x*y^3 + x^3*z + y*z^3) = - (b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)
### (x^3*y+y^3*z+z^3*x)* =>
2*b^2*(x^4*y^4+x^4*z^4+y^4*z^4 + E3*(x^5+y^5+z^5) + E3^2*E2) +
	+ (2*b^2*R*S^2 - 2*b*R*S^2 + 12*R^2 - 18*b*R^2)*(x^3*y+y^3*z+z^3*x) # = 0
2*b^2*(4*E2*E3^2 + E2^4 - 4*E2^2*E3*S + 2*E3^2*S^2 + E3*(S^5 - 5*E2*S^3 + 5*E3*S^2 + 5*E2^2*S - 5*E3*E2) + E3^2*E2) +
	+ (2*b^2*R*S^2 - 2*b*R*S^2 + 12*R^2 - 18*b*R^2)*(x^3*y+y^3*z+z^3*x) # = 0
2*b^2*(E3*S^5 - 5*E2*E3*S^3 + 7*E3^2*S^2 + E2^2*E3*S + E2^4) +
	+ (2*b^2*R*S^2 - 2*b*R*S^2 + 12*R^2 - 18*b*R^2)*(x^3*y+y^3*z+z^3*x) # = 0
# =>
2*b*(R*(S^2 - 2*E2)*S^4 - 5*E2*R*(S^2 - 2*E2)*S^2 + 7*R*(S^2 - 2*E2)*E3*S + E2^2*R*(S^2 - 2*E2) + b*E2^4) +
	+ (2*b^2*R*S^2 - 2*b*R*S^2 + 12*R^2 - 18*b*R^2)*(x^3*y+y^3*z+z^3*x) # = 0
2*(b*R*S^6 - 14*R^2*S^4 + 5*R^2*E2*S^2 + 31*R^2*E2^2) +
	+ (2*b^2*R*S^2 - 2*b*R*S^2 + 12*R^2 - 18*b*R^2)*(x^3*y+y^3*z+z^3*x) # = 0
(b^3*R*S^6 - 14*b^2*R^2*S^4 + 15*R^3*b*S^2 + 279*R^4) +
	+ b^2*(b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)*(x^3*y+y^3*z+z^3*x) # = 0
### (Eq 1) * (...) + Eq 2:
b^2*(b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)*(x*y^3 + x^3*z + y*z^3 + x^3*y + y^3*z + z^3*x) +
	+ (b^3*R*S^6 - 14*b^2*R^2*S^4 + 15*R^3*b*S^2 + 279*R^4) +
	+ (b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)*(b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)
b^2*(b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)*(E2*(S^2 - 2*E2) - E3*S) +
	+ (b^3*R*S^6 - 14*b^2*R^2*S^4 + 15*R^3*b*S^2 + 279*R^4) +
	+ (b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)*(b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)
(b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)*(2*b*R*S^2 - 12*R^2) +
	+ (b^3*R*S^6 - 14*b^2*R^2*S^4 + 15*R^3*b*S^2 + 279*R^4) +
	+ (b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)*(b^2*R*S^2 - b*R*S^2 + 6*R^2 - 9*b*R^2)
b^3*S^6 + R*(b^4 - 15*b^2)*S^4 + R^2*(27*b - 18*b^3)*S^2 + 81*R^3*(b^2 + 3)
(b*S^2 - 9*R)*(b^2*S^4 + R*(b^3 - 6*b)*S^2 - 9*R^2*(b^2 + 3))
(b*S^2 - 9*R)^2 * (b*S^2 + R*(b^2 + 3))


# [old][redundant]
### Sum((x^2+y^2)*...) =>
# b*(x^3*y + x*y^3 + x^3*z + x*z^3 + y^3*z + y*z^3) = 2*R*(x^2+y^2+z^2)
b*(E2*(S^2 - 2*E2) - E3*S) - 2*R*(S^2 - 2*E2) # = 0
b*E2*S^2 - 2*b*E2^2 - b*E3*S - 2*R*S^2 + 4*R*E2 # = 0
b*E2*S^2 - 2*b*E2^2 - R*(S^2 - 6*R / b) - 2*R*S^2 + 4*R*E2 # = 0
b^2*E2*S^2 - 2*b^2*E2^2 - R*(b*S^2 - 6*R) - 2*b*R*S^2 + 4*R*b*E2 # = 0
3*b*R*S^2 - 3*b*R*S^2 # = 0


#######################

###############
### Order 3 ###
###############

### Case 2:
# (x, y, z) NOT equal;

### Sum =>
b*E2 - 3*R # = 0
E2 = 3*R[1] / b[1]

### Sum(z^3*...) =>
# b*x*y*z*(x^2 + y^2 + z^2) = R*(x^3 + y^3 + z^3)
b*E3*(S^2 - 2*E2) - R*(S^3 - 3*E2*S + 3*E3) # = 0
(b*S^2 - 2*b*E2 - 3*R)*E3 - R*(S^3 - 3*E2*S) # = 0
(b*S^2 - 9*R)*E3 - R*(S^3 - 3*E2*S) # = 0
b*(b*S^2 - 9*R)*E3 - R*(b*S^3 - 9*R*S) # = 0

### Eq 3:
# x^3 - y^3 = R - b[1]*x*y
### sq =>
x^6 + y^6 - 2*x^3*y^3 - (R^2 + b[1]^2*x^2*y^2 - 2*b[1]*R*x*y) # = 0
### Sum() =>
2*(x^6 + y^6 + z^6) - 2*(x^3*y^3 + x^3*z^3 + y^3*z^3) - b[1]^2*(x^2*y^2 + x^2*z^2 + y^2*z^2) + 2*b[1]*R*E2 - 3*R^2
2*(- 2*E2^3 + 3*E3^2 - 12*E2*E3*S + 9*E2^2*S^2 + 6*E3*S^3 - 6*E2*S^4 + S^6) +
	- 2*(E2^3 - 3*E3*(E2*S - E3)) - b[1]^2*(E2^2 - 2*E3*S) + 2*b[1]*R*E2 - 3*R^2
- 6*E2^3 - b[1]^2*E2^2 - 18*E2*E3*S + 18*E2^2*S^2 + 12*E3*S^3 - 12*E2*S^4 + 2*S^6 + 2*b[1]^2*E3*S + 2*b[1]*R*E2 - 3*R^2
- 6*b[1]^3*E2^3 - b[1]^5*E2^2 - 18*b[1]^3*E2*E3*S + 18*b[1]^3*E2^2*S^2 +
	+ 12*b[1]^3*E3*S^3 - 12*b[1]^3*E2*S^4 + 2*b[1]^3*S^6 + 2*b[1]^5*E3*S + 2*b[1]^4*R*E2 - 3*b[1]^3*R^2
(12*b[1]^3*S^3 + 2*b[1]^5*S - 54*b[1]^2*R*S)*E3 +
	+ 2*b[1]^3*S^6 - 36*b[1]^2*R*S^4 + 2*81*b[1]*R^2*S^2 - 6*27*R^3 - 6*b[1]^3*R^2
R*(12*b[1]^3*S^3 + 2*b[1]^5*S - 54*b[1]^2*R*S)*(b[1]*S^3 - 9*R*S) +
	+ b[1]*(b[1]*S^2 - 9*R)*(2*b[1]^3*S^6 - 36*b[1]^2*R*S^4 + 2*81*b[1]*R^2*S^2 - 6*27*R^3 - 6*b[1]^3*R^2)

### =>
(27*R^3*b1^4 + 729*R^4*b1) +
	+ (- 12*R^2*b1^5 - 567*R^3*b1^2)*S^2 +
	+ (R*b1^6 + 162*R^2*b1^3)*S^4 +
	+ (- 21*R*b1^4)*S^6 + b1^5*S^8
(b[1]*S^2 - 9*R) * (b[1]^4*S^6 - 12*R*b[1]^3*S^4 + (R*b[1]^5 + 54*R^2*b[1]^2)*S^2 - (3*R^2*b[1]^4 + 81*R^3*b[1]))
(b[1]*S^2 - 9*R) * (b[1]*S^2 - 3*R) * (b[1]^3*S^4 - 9*R*b[1]^2*S^2 + (R*b[1]^4 + 27*R^2*b[1]))


coeff = c(b[1]^3, 0, - 9*R[1]*b[1]^2, 0, (R[1]*b[1]^4 + 27*R[1]^2*b[1]))


### Debug
x = 1.2583507026 + 1.1639791181i
y = 0.2282819654 - 1.0195743279i
z = 0.4163440587 + 0.6438339512i
#
S = x+y+z
E3 = x*y*z
E2 = x*y + x*z + y*z

### Test
x^3 - y^3 + b[1]*x*y # - R[1]
y^3 - z^3 + b[1]*y*z # - R[1]
z^3 - x^3 + b[1]*x*z # - R[1]

#############################
#############################

##########################
### Difference Types:  ###
### Variants           ###
##########################

### Product with (x+y+z)

### Example:
x^n - y^n + b*x*y*(x+y+z) = R
y^n - z^n + b*y*z*(x+y+z) = R
z^n - x^n + b*z*x*(x+y+z) = R


###############
### Order 2 ###
###############

### Solution:

### Sum(...) =>
# b*E2*S = 3*R
b*E2*S - 3*R # = 0

### Sum(z^2*...) =>
# b*E3*S^2 = R*(x^2 + y^2 + z^2)
b*E3*S^2 - R*(S^2 - 2*E2) # = 0

### Eq 3:
x^2 - y^2 = R - b*x*y*(x+y+z)
### sq =>
x^4 + y^4 - 2*x^2*y^2 - (R^2 + b^2*x^2*y^2*S^2 - 2*b*R*x*y*S) # = 0
### Sum(...) =>
2*(x^4 + y^4 + z^4) - 2*(x^2*y^2 + x^2*z^2 + y^2*z^2) +
	- 3*R^2 - b^2*S^2*(x^2*y^2 + x^2*z^2 + y^2*z^2) + 2*b*R*E2*S # = 0
2*(S^4 - 4*E2*S^2 + 4*E3*S + 2*E2^2) - 2*(E2^2 - 2*E3*S) +
	- 3*R^2 - b^2*S^2*(E2^2 - 2*E3*S) + 2*b*R*E2*S # = 0
2*S^4 + 2*b^2*E3*S^3 - b^2*E2^2*S^2 - 8*E2*S^2 + 12*E3*S + 2*E2^2 + 2*b*R*E2*S - 3*R^2 # = 0
2*S^4 + 2*b*R*S^3 - 8*E2*S^2 + 12*E3*S + 2*E2^2 - 18*R^2 # = 0
2*b^2*S^4 + 2*b^3*R*S^3 - 24*b*R*S + 12*b*b*E3*S + 2*b^2*E2^2 - 18*b^2*R^2 # = 0
2*b^2*S^6 + 2*b^3*R*S^5 - 12*b*R*S^3 - 18*b^2*R^2*S^2 - 54*R^2 # = 0
b^2*S^6 + b^3*R*S^5 - 6*b*R*S^3 - 9*b^2*R^2*S^2 - 27*R^2 # = 0

(b[1]*S^3 - 9*R) * (b[1]*S^3 + R*b[1]^2*S^2 + 3*R)


### Debug
R = 2
b = 3
#
x =  0.3839711784 + 2.6186496599i
y = -2.2520488675 - 1.5337851056i
z =  1.8953571195 - 0.5107692382i
#
S = x+y+z
E3 = x*y*z
E2 = x*y + x*z + y*z

### Test
x^2 - y^2 + b[1]*x*y*(x+y+z) # - R[1]
y^2 - z^2 + b[1]*y*z*(x+y+z) # - R[1]
z^2 - x^2 + b[1]*x*z*(x+y+z) # - R[1]


######################

######################
### Product with x*y*z

### Example:
x^n - y^n + b*x^2*y^2*z = R
y^n - z^n + b*x*y^2*z^2 = R
z^n - x^n + b*x^2*y*z^2 = R


###############
### Order 2 ###
###############

### Solution:

### Sum(...) =>
# b*E2*S = 3*R
b*E2*E3 - 3*R # = 0

### Sum(z^2*...) =>
# b*E3^2*S = R*(x^2 + y^2 + z^2)
b*E3^2*S - R*(S^2 - 2*E2) # = 0
b*E3^2*S + 2*R*E2 - R*S^2 # = 0
# =>
b^2*E3^3*S + 2*b*R*E2*E3 - b*R*S^2*E3
b^2*E3^3*S - b*R*S^2*E3 + 6*R^2
# b^2*E3^3*S = b*R*S^2*E3 - 6*R^2

### Eq 3:
x^2 - y^2 = R - b*x*y*E3
### sq =>
x^4 + y^4 - 2*x^2*y^2 - (R^2 + b^2*x^2*y^2*E3^2 - 2*b*R*x*y*E3) # = 0
### Sum(...) =>
2*(x^4 + y^4 + z^4) - 2*(x^2*y^2 + x^2*z^2 + y^2*z^2) +
	- 3*R^2 - b^2*E3^2*(x^2*y^2 + x^2*z^2 + y^2*z^2) + 2*b*R*E2*E3 # = 0
2*(S^4 - 4*E2*S^2 + 4*E3*S + 2*E2^2) - 2*(E2^2 - 2*E3*S) +
	- 3*R^2 - b^2*E3^2*(E2^2 - 2*E3*S) + 2*b*R*E2*E3 # = 0
2*S^4 - 8*E2*S^2 + 12*E3*S + 2*E2^2 - b^2*E3^2*E2^2 + 2*b^2*E3^3*S + 3*R^2 # = 0
2*S^4 - 8*E2*S^2 + 12*E3*S + 2*E2^2 - b^2*E3^2*E2^2 + 2*(b*R*S^2*E3 - 6*R^2) + 3*R^2 # = 0
(b^2*S^4 - 9*b^2*R^2)*E3^2 + (b^2*R^2*S^3 - 6*b*R*S^2)*E3 - 6*b*R^3*S - 27*R^2 # = 0
# =>
(R*S^10*b^5 - 63*R^2*S^5*b^4 - 12*R^3*S^6*b^5 + 243*R^4*S*b^4 - R^4*S^7*b^6 + 135*R^5*S^2*b^5)*E3 +
(- 6*R^2*S^8*b^4 - 162*R^3*S^3*b^3 + 99*R^4*S^4*b^4 + 6*R^5*S^5*b^5 - 486*R^6*b^4) # = 0

### Eq:
(b[1]*S^5 - 243*R[1]) *
	(b[1]*S^7 - b[1]^2*R[1]^3*S^4 - 8*b[1]*R[1]^2*S^3 - 3*R[1]*S^2 - 4*b[1]^2*R[1]^5) *
	# NOT part of solution!
	(R*b^2*S^13 - 12*b*S^12 - R^4*b^3*S^10 + 162*R^2*b*S^8 + 216*R*S^7 + 81*R^5*b^2*S^5 +
	- 1944*R^4*b*S^4 + 4374*R^6*b)

coeff = c(R*b^3, - 12*b^2, 0, - 2*R^4*b^4, 4*R^3*b^3, 255*R^2*b^2, (252*R*b + R^7*b^5), # S^14
	4*R^6*b^4, - 30*R^5*b^3, - 3456*R^4*b^2, (- 2214*R^3*b + 4*R^9*b^5), # S^10
	(- 648*R^2 - 81*R^8*b^4), 648*R^7*b^3, 18819*R^6*b^2, 5832*R^5*b, - 324*R^10*b^4,
	3402*R^9*b^3, - 34992*R^8*b^2, - 13122*R^7*b, 0, - 17496*R^11*b^3)

(- 17496*R^11*b^3) +
(- 13122*R^7*b)*S^2 +
(- 34992*R^8*b^2)*S^3 +
(3402*R^9*b^3)*S^4 +
(- 324*R^10*b^4)*S^5 +
(5832*R^5*b)*S^6 +
(18819*R^6*b^2)*S^7 +
(648*R^7*b^3)*S^8 +
(- 648*R^2 - 81*R^8*b^4)*S^9 +
(- 2214*R^3*b + 4*R^9*b^5)*S^10 +
(- 3456*R^4*b^2)*S^11 +
(- 30*R^5*b^3)*S^12 +
(4*R^6*b^4)*S^13 +
(252*R*b + R^7*b^5)*S^14 +
(255*R^2*b^2)*S^15 +
(4*R^3*b^3)*S^16 +
(- 2*R^4*b^4)*S^17 +
(- 12*b^2)*S^19 +
(R*b^3)*S^20


### Debug

### TODO:
# - evaluate if S = 0 can also have solutions;

R = 2
b = 3
#
x = -0.7109106918 + 2.9930808149i
y = -0.4641949120 - 0.6960109886i
z =  0.2278775551 + 0.5211276192i
#
S = x+y+z
E3 = x*y*z
E2 = x*y + x*z + y*z

### Test
x^2 - y^2 + b[1]*x*y*(x*y*z) # - R[1]
y^2 - z^2 + b[1]*y*z*(x*y*z) # - R[1]
z^2 - x^2 + b[1]*x*z*(x*y*z) # - R[1]


coeff.c = c();
coeff.c = (c(4, 25, 28, 40, 43, 55, 58) - 1) / 3
coeff.c = (c(4, 28, 31, 46, 49, 55, 58) - 1) / 3;
S = sol[(0:19)*3+1, 4]
round0.p(poly.calc(S[coeff.c + 1]))
round0.p(poly.calc(S[-coeff.c - 1]))

R = 1; b = 1;
-4 - 3*x^2 - 8*x^3 - x^4 + x^7
R = 2; b = 1;
-128 - 6*x^2 - 32*x^3 - 8*x^4 + x^7
R = 1; b = 2;
-8 - 1.5*x^2 - 8*x^3 - 2*x^4 + x^7

b*S^7 - b^2*R^3*S^4 - 8*b*R^2*S^3 - 3*R*S^2 - 4*b^2*R^5


############################
############################

#   x^3 + y^3 - z^3 + b*x = R
# - x^3 + y^3 + z^3 + b*y = R
#   x^3 - y^3 + z^3 + b*z = R

### Solution:

### Sum(x*...) =>
(x^4 + y^4 + z^4) + (x*y^3 + y*z^3 + z*x^3) - (x*z^3 + y*x^3 + z*y^3) +
	+ b*(x^2 + y^2 + z^2) - R*S # = 0
(S^4 - 4*E2*S^2 + 4*E3*S + 2*E2^2) +
	+ (x*y^3 + y*z^3 + z*x^3 + x*z^3 + y*x^3 + z*y^3) - 2*(x*z^3 + y*x^3 + z*y^3) +
	+ b*(S^2 - 2*E2) - R*S # = 0
# 2*(x*z^3 + y*x^3 + z*y^3) # =
(S^4 - 4*E2*S^2 + 4*E3*S + 2*E2^2) +
	+ (S*(S^3 - 3*E2*S + 3*E3) - (S^4 - 4*E2*S^2 + 4*E3*S + 2*E2^2)) +
	+ b*(S^2 - 2*E2) - R*S
S^4 - 3*E2*S^2 + 3*E3*S + b*S^2 - 2*b*E2 - R*S # Eq-bis-1
# 2*(x*z^3 + y*x^3 + z*y^3)*(x*y^3 + y*z^3 + z*x^3) # =
2*(E3*S^5 - 5*E2*E3*S^3 + 7*E3^2*S^2 + E2^2*E3*S + E2^4) # =
(S^4 - 3*E2*S^2 + 3*E3*S + b*S^2 - 2*b*E2 - R*S)*(x*y^3 + y*z^3 + z*x^3) # Eq-bis-2
### (...)*Eq-bis-1 + 2*Eq-bis-2 =>
2*(S^4 - 3*E2*S^2 + 3*E3*S + b*S^2 - 2*b*E2 - R*S) *
	(E2*S^2 - E3*S - 2*E2^2) +
	- (S^4 - 3*E2*S^2 + 3*E3*S + b*S^2 - 2*b*E2 - R*S)^2 +
	- 4*(E3*S^5 - 5*E2*E3*S^3 + 7*E3^2*S^2 + E2^2*E3*S + E2^4) # = 0
#
(4*E2^2*b^2 - 8*E2^3*b + 4*E2^4) +
(- 16*E2*E3*b + 4*E2*R*b + 16*E2^2*E3 - 4*E2^2*R)*S^1 +
(- 4*E2*b^2 + 20*E2^2*b - 12*E2^3 - 8*E3*R + 43*E3^2 + R^2)*S^2 +
(- 50*E2*E3 + 8*E2*R + 8*E3*b - 2*R*b)*S^3 +
(- 12*E2*b + 19*E2^2 + b^2)*S^4 +
(12*E3 - 2*R)*S^5 +
(- 8*E2 + 2*b)*S^6 + S^8

### Eq:
16*S^8 + 24*b*S^6 + 72*b^2*S^4 - 216*b*R*S^3 +
	+ (432*R^2 + 46*b^3)*S^2 - 108*b^2*R*S + 9*b^4
 

### Classic Polynomial:
# P[3] * P[24]
(8*R^2*b^9 + 4096*R^8 + b^12) +
(- 4*R*b^10 - 768*R^5*b^4 - 14336*R^7*b)*x^1 +
(48*R^2*b^8 + 1536*R^4*b^5 + 22528*R^6*b^2 + 2*b^11)*x^2 +
(- 40*R*b^9 - 1344*R^3*b^6 - 22016*R^5*b^3 - 32768*R^7)*x^3 +
(768*R^2*b^7 + 18688*R^4*b^4 + 100352*R^6*b + 16*b^10)*x^4 +
(- 336*R*b^8 - 13184*R^3*b^5 - 135168*R^5*b^2)*x^5 +
(6400*R^2*b^6 + 110080*R^4*b^3 + 114688*R^6 + 80*b^9)*x^6 +
(- 2048*R*b^7 - 67072*R^3*b^4 - 301056*R^5*b)*x^7 +
(30336*R^2*b^5 + 337920*R^4*b^2 + 352*b^8)*x^8 +
(- 8768*R*b^6 - 220160*R^3*b^3 - 229376*R^5)*x^9 +
(96768*R^2*b^4 + 501760*R^4*b + 1280*b^7)*x^10 +
(- 27264*R*b^5 - 450560*R^3*b^2)*x^11 +
(220160*R^2*b^3 + 286720*R^4 + 3712*b^6)*x^12 +
(- 63232*R*b^4 - 501760*R^3*b)*x^13 +
(337920*R^2*b^2 + 8576*b^5)*x^14 +
(- 110080*R*b^3 - 229376*R^3)*x^15 +
(301056*R^2*b + 15616*b^4)*x^16 +
(- 135168*R*b^2)*x^17 +
(114688*R^2 + 22016*b^3)*x^18 +
(- 100352*R*b)*x^19 +
(22528*b^2)*x^20 +
(- 32768*R)*x^21 +
(14336*b)*x^22 +
(4096)*x^24

solve.L3.S3P3 = function(R, b, debug=FALSE) {
	coeff = c((8*R^2*b^9 + 4096*R^8 + b^12),
	(- 4*R*b^10 - 768*R^5*b^4 - 14336*R^7*b),
	(48*R^2*b^8 + 1536*R^4*b^5 + 22528*R^6*b^2 + 2*b^11),
	(- 40*R*b^9 - 1344*R^3*b^6 - 22016*R^5*b^3 - 32768*R^7),
	(768*R^2*b^7 + 18688*R^4*b^4 + 100352*R^6*b + 16*b^10),
	(- 336*R*b^8 - 13184*R^3*b^5 - 135168*R^5*b^2),
	(6400*R^2*b^6 + 110080*R^4*b^3 + 114688*R^6 + 80*b^9),
	(- 2048*R*b^7 - 67072*R^3*b^4 - 301056*R^5*b),
	(30336*R^2*b^5 + 337920*R^4*b^2 + 352*b^8),
	(- 8768*R*b^6 - 220160*R^3*b^3 - 229376*R^5),
	(96768*R^2*b^4 + 501760*R^4*b + 1280*b^7),
	(- 27264*R*b^5 - 450560*R^3*b^2),
	(220160*R^2*b^3 + 286720*R^4 + 3712*b^6),
	(- 63232*R*b^4 - 501760*R^3*b),
	(337920*R^2*b^2 + 8576*b^5),
	(- 110080*R*b^3 - 229376*R^3),
	(301056*R^2*b + 15616*b^4),
	(- 135168*R*b^2),
	114688*R^2 + 22016*b^3,
	- 100352*R*b, 22528*b^2,
	- 32768*R, 14336*b, 0, 4096)
	coeff = rev(coeff);
	x = roots(coeff)
	z = (2*R - 2*x^3 - b*x) / b;
	y = (2*R - 2*z^3 - b*z) / b;
	return(data.frame(x=x, y=y, z=z, S=x+y+z))
}

######################
######################
######################

######################
### B. Non-Trivial ###
######################

### Type:
### x^n - x^(n-k)*y^k

### Order 3:
# x^3 - x^2*y + b*z = R;

### Solution:

### Analysis:

### Branch Points:
# x^3 - x^2*y = 0 =>
# x = y =>
# - for this simple System:
#   => x = y = z = R/b;
# - the branch point affects only the trivial solution;
# - very special case: when R^2 - b^3 = 0;

### Special Case:
# x = y; z = R/b;
x^3 - x^2*z + b*x - R # = 0
z^3 - z^2*x + b*x - R # = 0
# =>
b*x^3 - R*x^2 + b^2*x - b*R # = 0 (Eq Sp-1)
(R^2 - b^3)*(R - b*x) # = 0
### Case: R^2 = b^3 = k^6
# z = R / b = k;
# Eq  Sp-1 =>
(x - k)*(x^2 + k^2) # = 0
# Additional solution:
# (k*1i, k*1i, k), (-k*1i, -k*1i, k);


### Helper Eqs:

### H1: E21a
# Sum =>
(x^3 + y^3 + z^3) - E21a + b*S - 3*R # = 0
S^3 - 3*E2*S + 3*E3 + b*S - E21a - 3*R # = 0

### H2: E31a & E31b:
# H2a: Sum(z*...) =>
E31b - E3*S + b*(S^2 - 2*E2) - R*S # = 0

# H2b: Sum(x*...) =>
(x^4 + y^4 + z^4) - E31a + b*E2 - R*S # = 0
S^4 - 4*S^2*E2 + 2*E2^2 + 4*E3*S - E31a + b*E2 - R*S # = 0

# H2c: Sum(y*...) =>
# (may be redundant)
E31a - (x^2*y^2 + x^2*z^2 + y^2*z^2) + b*E2 - R*S # = 0
E31a - E2^2 + 2*E3*S + b*E2 - R*S # = 0


### H3: E32a & E32b:
# H3a: Sum(y^2*...) =>
E32a - E32b + b*E21a - R*(S^2 - 2*E2) # = 0
# + b * Eq 1 =>
E32a - E32b + b*(S^3 - 3*E2*S + 3*E3 + b*S) - R*(S^2 - 2*E2) - 3*b*R # = 0

# H3b: Sum(z^2*...) =>
E32b - E3*E2 + b*(S^3 - 3*E2*S + 3*E3) - R*(S^2 - 2*E2) # = 0


### Eq 1:
# Eq (H2a) - Eq (H2b) =>
E31a + E31b - 5*E3*S - 2*E2^2 + 4*E2*S^2 - 3*b*E2 - S^4 + b*S^2 # = 0
E2*(S^2 - 2*E2) - E3*S +
	- 5*E3*S - 2*E2^2 + 4*E2*S^2 - 3*b*E2 - S^4 + b*S^2 # = 0
6*E3*S + 4*E2^2 - 5*E2*S^2 + 3*b*E2 + S^4 - b*S^2 # = 0

# TODO


### Debug:
R = 3; b = 2;
x = -0.1563178728 + 1.2244913373i;
y =  1.5360342822 - 0.1238932578i;
z = -0.0061562585 + 0.6704627959i;
S = x+y+z; E2 = (x+y)*z + x*y; E3 = x*y*z;
n = 2;
E21a = x^n*y + y^n*z + z^n*x;
E21b = x*y^n + y*z^n + z*x^n;
n = 3;
E31a = x^n*y + y^n*z + z^n*x;
E31b = x*y^n + y*z^n + z*x^n;
n = 3; m = 2;
E32a = x^n*y^m + y^n*z^m + z^n*x^m;
E32b = x^m*y^n + y^m*z^n + z^m*x^n;

### Test:
x^3 - x^2*y + b*z # = R
y^3 - y^2*z + b*x # = R
z^3 - z^2*x + b*y # = R

