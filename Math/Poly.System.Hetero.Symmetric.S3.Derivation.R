########################
###
### Leonard Mada
### [the one and only]
###
### Polynomial Systems: S3
### Heterogeneous Symmetric
###  == Derivation ==
###
### draft v.0.1a


###############
### History ###
###############


### draft v.0.1a:
# - cleanup;
# - moved derivation from file:
#   Poly.System.Hetero.Symmetric.S3.R
#   to this file;

####################
####################

### helper functions

library(polynom)
library(pracma)

# the functions are in the file:
# Polynomials.Helper.R
# - e.g. round0(), round0.p(),
#   solve.EnAll(), solveEn();

### other
# ...


###################

################
###  Simple  ###
################

###############
### Order 2 ###
###############

# ...

###################

###############
### Order 3 ###
###############

# ...

########################

########################
### Mixed Side-Chain ###
########################

### x[i]^3 + b2*x[j]^2 + b1*x[k]

# x^3 + b2*y^2 + b1*z = R
# y^3 + b2*z^2 + b1*x = R
# z^3 + b2*x^2 + b1*y = R


### Solution:

### Sum =>
(x^3 + y^3 + z^3) + b2*(x^2 + y^2 + z^2) + b1*S - 3*R # = 0
S^3 - 3*E2*S + 3*E3 + b2*(S^2 - 2*E2) + b1*S - 3*R # = 0
S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 + 3*E3 - 3*R # = 0
# 3*E3 = -(S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 - 3*R)

### Eq2:
# x^3 + b1*z = R - b2*y^2
# x^3 + b1*y + b1*z = R - b2*y^2 + b1*y # Sq =>
# (x^3 + b1*y + b1*z)^2 = (b2*y^2 - b1*y - R)^2
x^6 + b1^2*y^2 + b1^2*z^2 + 2*b1*x^3*y + 2*b1*x^3*z + 2*b1^2*y*z # =
	b2^2*y^4 + b1^2*y^2 + R^2 - 2*b1*b2*y^3 - 2*b2*R*y^2 + 2*b1*R*y
### Sum =>
(x^6+y^6+z^6) + 2*b1^2*(x^2+y^2+z^2) + 2*b1*(x^3*y+x^3*z+y^3*x+y^3*z+z^3*x+z^3*y) + 2*b1^2*E2 # =
	b2^2*(x^4+y^4+z^4) - 2*b1*b2*(x^3+y^3+z^3) + (b1^2 - 2*b2*R)*(x^2+y^2+z^2) + 2*b1*R*S + 3*R^2
### sum(x^3*y) = (x^2+y^2+z^2)*E2 - E3*S
- 3*E3^2 + 12*E2*E3*S - 6*E3*S^3 + 4*b2^2*E3*S + 2*b1*E3*S - 6*b1*b2*E3 +
	+ 2*E2^3 - 9*E2^2*S^2 + 2*b2^2*E2^2 + 4*b1*E2^2 +
	+ 6*E2*S^4 - 4*b2^2*E2*S^2 - 2*b1*E2*S^2 + 6*b1*b2*E2*S + 4*b2*R*E2 +
	- S^6 + b2^2*S^4 - 2*b1*b2*S^3 - 2*b2*R*S^2 - b1^2*S^2  + 2*b1*R*S + 3*R^2 # = 0

### Eq3:
# x^3 + b2*y^2 = R - b1*z
# x^3 + b2*y^2 + b2*z^2 = b2*z^2 - b1*z + R
# (x^3 + b2*y^2 + b2*z^2)^2 = (b2*z^2 - b1*z + R)^2
x^6 + 2*b2*x^3*y^2 + 2*b2*x^3*z^2 + b2^2*y^4 + b2^2*z^4 + 2*b2^2*y^2*z^2 # =
	b2^2*z^4 - 2*b1*b2*z^3 + b1^2*z^2 + 2*b2*R*z^2 - 2*b1*R*z + R^2
### Sum =>
(x^6+y^6+z^6) + 2*b2^2*(x^4+y^4+z^4) + 2*b2^2*(E2^2 - 2*E3*S) +
	+ 2*b2*(x^3*y^2+x^3*z^2+y^3*x^2+y^3*z^2+z^3*x^2+z^3*y^2) # =
	b2^2*(x^4+y^4+z^4) - 2*b1*b2*(x^3+y^3+z^3) + (b1^2 + 2*b2*R)*(x^2+y^2+z^2) - 2*b1*R*S + 3*R^2
### sum(x^3*y^2) = (E2^2 - 2*E3*S)*S - E3*E2
3*E3^2 - 12*E2*E3*S - 2*b2*E2*E3 + 6*E3*S^3 - 4*b2*E3*S^2 + 6*b1*b2*E3 +
	- 2*E2^3 + 9*E2^2*S^2 + 2*b2*E2^2*S + 4*b2^2*E2^2 +
	- 6*E2*S^4 - 4*b2^2*E2*S^2 - 6*b1*b2*E2*S + 2*b1^2*E2 + 4*b2*R*E2 +
	+ S^6 + b2^2*S^4 + 2*b1*b2*S^3 - b1^2*S^2 - 2*b2*R*S^2 + 2*b1*R*S - 3*R^2 # = 0
# Diff: Eq 2 - Eq 3 =>
b2*E2*E3 + 2*b2*E3*S^2 - 2*b2^2*E3*S - b1*E3*S +
	- b2*E2^2*S - 3*b2^2*E2^2 - 2*b1*E2^2 +
	+ 4*b2^2*E2*S^2 + b1*E2*S^2 - b1^2*E2 - 4*b2*R*E2 +
	- b2^2*S^4 + b1^2*S^2 + 2*b2*R*S^2 - 2*b1*R*S # = 0

# =>
# 3*E3 = -(S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 - 3*R)
pE3x3 = data.frame(
	E2 = c(0, 0, 0, 1, 1, 0),
	S  = c(3, 2, 1, 1, 0, 0),
	b1 = c(0, 0, 1, 0, 0, 0),
	b2 = c(0, 1, 0, 0, 1, 0),
	R  = c(0, 0, 0, 0, 0, 1),
	coeff = c(-1,-1,-1, 3, 2, 3)
)
p2 = data.frame(
	E3 = c(1, 1, 1, 1,   0, 0, 0,   0, 0, 0, 0,   0, 0, 0, 0),
	E2 = c(1, 0, 0, 0,   2, 2, 2,   1, 1, 1, 1,   0, 0, 0, 0),
	S  = c(0, 2, 1, 1,   1, 0, 0,   2, 2, 0, 0,   4, 2, 2, 1),
	b1 = c(0, 0, 0, 1,   0, 0, 1,   0, 1, 2, 0,   0, 2, 0, 1),
	b2 = c(1, 1, 2, 0,   1, 2, 0,   2, 0, 0, 1,   2, 0, 1, 0),
	R  = c(0, 0, 0, 0,   0, 0, 0,   0, 0, 0, 1,   0, 0, 1, 1),
	coeff = c(1, 2, -2,-1, -1,-3,-2,  4, 1,-1,-4, -1, 1, 2,-2)
)
p3 = data.frame(
	E3 = c(2, 1, 1, 1, 1, 1,   0, 0, 0, 0,   0, 0, 0, 0, 0,   0, 0, 0, 0, 0, 0, 0),
	E2 = c(0, 1, 1, 0, 0, 0,   3, 2, 2, 2,   1, 1, 1, 1, 1,   0, 0, 0, 0, 0, 0, 0),
	S  = c(0, 1, 0, 3, 2, 0,   0, 2, 1, 0,   4, 2, 1, 0, 0,   6, 4, 3, 2, 2, 1, 0),
	b1 = c(0, 0, 0, 0, 0, 1,   0, 0, 0, 0,   0, 0, 1, 2, 0,   0, 0, 1, 2, 0, 1, 0),
	b2 = c(0, 0, 1, 0, 1, 1,   0, 0, 1, 2,   0, 2, 1, 0, 1,   0, 2, 1, 0, 1, 0, 0),
	R  = c(0, 0, 0, 0, 0, 0,   0, 0, 0, 0,   0, 0, 0, 0, 1,   0, 0, 0, 0, 1, 1, 2),
	coeff = c(3,-12,-2,6,-4,6,  -2, 9, 2, 4,  -6,-4,-6, 2, 4,  1, 1, 2,-1,-2, 2,-3)
)
# Debug
eval.pm(p2, c(E3, E2, S, b1, b2, R))
eval.pm(p3, c(E3, E2, S, b1, b2, R))

### Solve:
p2r = replace.fr.pm(p2, p1, 3, "E3", 1)
p2r$coeff = - p2r$coeff;
p2r = sort.pm(p2r, c(4,5,3), xn=c("E2","S"))

p3r = replace.fr.pm(p3, p1, 3, "E3", 1)
p3r$coeff = - p3r$coeff / 6;
p3r = sort.pm(p3r, c(4,5,3), xn=c("E2","S"))

7*b2^2*E2^2 + 6*b1*E2^2 - 5*S^3*b2*E2 - 9*S^2*b2^2*E2 + 4*S*b2^3*E2 + 3*S*b1*b2*E2 + 3*b1^2*E2 + 9*b2*R*E2 +
	+ 2*S^5*b2 + 3*S^4*b2^2 - S^4*b1 - 2*S^3*b2^3 + S^3*b1*b2 - 2*S^2*b1*b2^2 - 4*S^2*b1^2 +
	- 12*S^2*b2*R + 6*S*b2^2*R + 9*S*b1*R

3*E2^3 + 6*S*b2*E2^2 - 6*b2^2*E2^2 - 3*S^4*E2 - 2*S^3*b2*E2 - 3*S^2*b1*E2 + 11*S^2*b2^2*E2 +
	+ S*b1*b2*E2 + 9*S*R*E2 - 3*b1^2*E2 - 6*b1*b2^2*E2 - 9*b2*R*E2 +
	+ S^6 + 2*S^4*b1 - 4*S^4*b2^2 - 3*S^3*b1*b2 - 6*S^3*R +
	+ S^2*b1^2 + 3*S^2*b1*b2^2 + 12*S^2*b2*R + 3*S*b1^2*b2 - 9*b1*b2*R

pS = solve.pm(p2r, p3r, "E2")

library(gmp)
pSr = pS[[1]]; pSr$coeff = as.bigz(pSr$coeff);
pDiv = data.frame(
	S=c(3,2,1,0), b2=c(0,1,0,0), b1=c(0,0,1,0), R=c(0,0,0,1),
	coeff=c(1, 3, 9, -27));
pDivInt = pDiv;
pDiv$coeff = as.bigz(pDiv$coeff);
pSd = div.bigpm(pSr, pDiv, by="S")
pSd = pSd[[1]];

pSd$coeff = as.numeric(pSd$coeff)
pSd = sort.pm(pSd, c(4,3), xn=c("S"))
pSd
eval.pm(pSd, c(S, b1, b2, R))
# P[12]
# TODO: factorize to P[8];


### Test:
x^3 + b2*y^2 + b1*z # - R
y^3 + b2*z^2 + b1*x # - R
z^3 + b2*x^2 + b1*y # - R

### Debug:
R = 3; b = c(2,-1);
b1 = b[1]; b2 = b[2];
x = -1.6372728335 + 0.4783896280i;
y = -1.0979359210 - 1.8696544136i;
z =  1.9873631239 + 0.1839015917i;
S = x+y+z; E2 = x*y+x*z+y*z; E3 = x*y*z;

