########################
###
### Leonard Mada
### [the one and only]
###
### Polynomial Systems: S3
### Heterogeneous Symmetric
###  == Derivation ==
###
### draft v.0.1a


###############
### History ###
###############


### draft v.0.1a:
# - cleanup;
# - moved derivation from file:
#   Poly.System.Hetero.Symmetric.S3.R
#   to this file;

####################
####################

### helper functions

library(polynom)
library(pracma)

# the functions are in the file:
# Polynomials.Helper.R
# - e.g. round0(), round0.p(),
#   solve.EnAll(), solveEn();

### other
# ...


###################

################
###  Simple  ###
################

###############
### Order 2 ###
###############

# x^2 + b1*y = R
# y^2 + b1*z = R
# z^2 + b1*x = R


### Solution

# Trivial solution: x = y = z;

### Method 1:
### Sum =>
x^2 + y^2 + z^2 + b1*(x+y+z) - 3*R # = 0
S^2 - 2*E2 + b1*S - 3*R # = 0
# 2*E2 = S^2 + b1*S - 3*R;

### Sum(x[i]*...) =>
x^3 + y^3 + z^3 + b1*E2 - R*S # = 0
S^3 - 3*E2*S + 3*E3 + b1*E2 - R*S # = 0
2*S^3 - 6*E2*S + 6*E3 + 2*b1*E2 - 2*R*S
2*S^3 - 3*(S^2 + b1*S - 3*R)*S + 6*E3 + b1*(S^2 + b1*S - 3*R) - 2*R*S
6*E3 - S^3 - 2*b1*S^2 + 7*R*S + b1^2*S - 3*b1*R
# 6*E3 = S^3 + 2*b1*S^2 - 7*R*S - b1^2*S + 3*b1*R

### Sum(x[i+1]^2*...) =>
E2^2 - 2*E3*S + b1*(S^3 - 3*E2*S + 3*E3) - R*(S^2 - 2*E2) # = 0
(S^2 + b1*S - 3*R)^2 - 8*E3*S + b1*(4*S^3 - 6*(S^2 + b1*S - 3*R)*S + 12*E3) - 4*R*(S^2 - (S^2 + b1*S - 3*R))
(S^2 + b1*S - 3*R)^2 - 8*E3*S + b1*(-2*S^3 - 6*b1*S^2 + 22*R*S + 12*E3) - 12*R^2
S^4 - 6*R*S^2 - 5*b1^2*S^2 + 16*b1*R*S - 8*E3*S + 12*b1*E3 - 3*R^2
S^4 + 2*b1*S^3 - (10*R + b1^2)*S^2 + 6*(b1*R + b1^3)*S - 18*b1^2*R + 9*R^2

### Eq:
(S^2 + 3*b1*S - 9*R)*(S^2 - b1*S - R + 2*b1^2)


### [old]

### Diff =>
# - simplification for Order 2:
# x^2 - y^2 = b1*(z-y)
# y^2 - z^2 = b1*(x-z)
# z^2 - x^2 = b1*(y-x)
# Prod =>
# (x+y)*(x+z)*(y+z) = (-1)*b1^3;
# S^3 - (x^3 + y^3 + z^3) + 3*b1^3 = 0;

# [Prod] =>
# (x^2 + x*y + x*z + y*z)*(y+z) = - b1^3
# S[x^2*y] + 2*x*y*z + b1^3 = 0;
# E2*S - 3*E3 + 2*E3 + b1^3 = 0;
# E2*S - E3 + b1^3 = 0


### Classic Polynomial:

### Alternative:
### Method 2: classic
# b1*y = R - x^2
# b1^3*z = b1^2*R - (R - x^2)^2
# b1^3*z = b1^2*R - R^2 - x^4 + 2*R*x^2
# =>
# x^8 - 4*R*x^6 + (6*R^2 - 2*b1^2*R)*x^4 + 4*R^2*(b1^2 - R)*x^2 + b[1]^7*x + (b1^2*R - R^2)^2 - b[1]^6*R = 0
# (x^2 + b1*x - R) * P6;
- R*b[1]^4 + 2*R^2*b[1]^2 - R^3 + b[1]^6 + (2*R*b[1]^3 - R^2*b[1] - b[1]^5)*x + (3*R^2 - 3*R*b[1]^2 + b[1]^4)*x^2 +
	+ (2*R*b[1] - b[1]^3)*x^3 - (3*R - b[1]^2)*x^4 - b[1]*x^5 + x^6

### Debug:
### alternative / classic
coeff = c(1,0, - 4*R,0, (6*R^2 - 2*b[1]^2*R), 0, 4*R^2*(b[1]^2 - R), b[1]^7, (b[1]^2*R - R^2)^2 - b[1]^6*R)
x = roots(coeff)
y = (R - x^2)/b[1]
z = (R - y^2)/b[1]
sol = cbind(x, y, z)
sol

### Test
x^2 + b[1]*y
y^2 + b[1]*z
z^2 + b[1]*x


###################

###############
### Order 3 ###
###############

# ...



#############################

#############################
### Univariate Side-Chain ###
#############################

### x[i]^3 + b2*x[j]^2 + b1*x[j]

# x^3 + b2*y^2 + b1*y = R
# y^3 + b2*z^2 + b1*z = R
# z^3 + b2*x^2 + b1*x = R


### Solution:

### Case: (x, y, z) distinct

### Sum =>
x^3 + y^3 + z^3) + b2*(x^2 + y^2 + z^2) + b1*S - 3*R # = 0
S^3 - 3*E2*S + 3*E3 + b2*(S^2 - 2*E2) + b1*S - 3*R # = 0
S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 + 3*E3 - 3*R # = 0
# 3*E3 = -(S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 - 3*R)


### Sum( (b[1]*x[i] + b[2]*x[i]^2) * ...) =>
b[2]*(x^5 + y^5 + z^5) + b[1]*(x^4 + y^4 + z^4) +
	+ b[1]*b[2]*(x^2*y + x*y^2 + x^2*z + x*z^2 + y^2*z + y*z^2) + b[1]^2*E2 + b[2]^2*(E2^2 - 2*E3*S) +
	- b[2]*R*(x^2+y^2+z^2) - b[1]*R*S # = 0
b[2]*(S^5 - 5*E2*S^3 + 5*E3*S^2 + 5*E2^2*S - 5*E2*E3) + b[1]*(S^4 - 4*E2*S^2 + 4*E3*S + 2*E2^2) +
	+ b[1]*b[2]*(E2*S - 3*E3) + b[1]^2*E2 + b[2]^2*(E2^2 - 2*E3*S) +
	- b[2]*R*(S^2 - 2*E2) - b[1]*R*S # = 0
b2*S^5 + b1*S^4 - 5*b2*E2*S^3 + 5*b2*E3*S^2 - 5*b2*E2*E3 + 4*b1*E3*S - 2*b2^2*E3*S +
	- 4*b1*E2*S^2 + 5*b2*E2^2*S - 2*b1*b2*E2*S +
	+ 2*b1*E2^2 + b2^2*E2^2 + b1^2*E2 - 2*b1*b2^2*E2 +
	+ b1*b2*S^3 + b1*b2^2*S^2 + b1^2*b2*S +
	- b2*R*S^2 + 2*b2*R*E2 - b1*R*S - 3*b1*b2*R # = 0


### Sum(y^3*...) =>
(x^3*y^3 + x^3*z^3 + y^3*z^3) + b2*(x^5 + y^5 + z^5) + b1*(x^4 + y^4 + z^4) +
	- R*(x^3 + y^3 + z^3) # = 0
(E2^3 - 3*E3*(E2*S - E3)) +
	+ b2*(S^5 - 5*E2*S^3 + 5*E3*S^2 + 5*E2^2*S - 5*E2*E3) +
	+ b1*(S^4 - 4*E2*S^2 + 4*E3*S + 2*E2^2) +
	- R*(S^3 - 3*E2*S + 3*E3) # = 0
E2^3 - 3*E3*E2*S + 3*E3^2 +
	+ b2*S^5 - 5*b2*E2*S^3 + 5*b2*E3*S^2 + 5*b2*E2^2*S - 5*b2*E2*E3 +
	+ b1*S^4 - 4*b1*E2*S^2 + 4*b1*E3*S + 2*b1*E2^2 +
	- R*S^3 + 3*R*E2*S - 3*R*E3 # = 0


### Auxiliary Eqs:
E2Subst = 1701*R*S*b1*b2^4 - 243*R*S*b1^3 - 756*R*S*b2^6 + 918*R*S^2*b1*b2^3 - 243*R*S^2*b1^2*b2 + 288*R*S^2*b2^5 - 1782*R*S^3*b1*b2^2 + 648*R*S^3*b1^2 + 450*R*S^3*b2^4 - 486*R*S^4*b1*b2 - 945*R*S^4*b2^3 - 702*R*S^5*b2^2 - 1134*R*b1*b2^5 + 1620*R*b1^2*b2^3 - 729*R*b1^3*b2 + 729*R^2*S*b1*b2 - 486*R^2*S*b2^3 + 972*R^2*S^2*b2^2 - 729*R^2*b1*b2^2 + 378*S*b1^2*b2^5 - 540*S*b1^3*b2^3 + 243*S*b1^4*b2 + 630*S^2*b1*b2^6 - 1233*S^2*b1^2*b2^4 + 504*S^2*b1^3*b2^2 - 537*S^3*b1*b2^5 - 180*S^3*b1^2*b2^3 + 90*S^3*b1^3*b2 + 252*S^3*b2^7 - 516*S^4*b1*b2^4 + 540*S^4*b1^2*b2^2 - 189*S^4*b1^3 + 30*S^4*b2^6 + 576*S^5*b1*b2^3 - 27*S^5*b1^2*b2 - 144*S^5*b2^5 + 513*S^6*b1*b2^2 - 108*S^6*b1^2 + 186*S^6*b2^4 + 45*S^7*b1*b2 + 297*S^7*b2^3 + 90*S^8*b2^2;

E2Div = 1539*R*S*b1*b2^2 - 486*R*S*b1^2 - 459*R*S*b2^4 + 648*R*S^2*b1*b2 + 702*R*S^2*b2^3 + 810*R*S^3*b2^2 - 567*R*b1*b2^3 + 189*R*b2^5 - 729*R^2*b2^2 + 819*S*b1*b2^5 - 45*S*b1^2*b2^3 - 108*S*b1^3*b2 - 504*S*b2^7 + 954*S^2*b1*b2^4 - 621*S^2*b1^2*b2^2 + 108*S^2*b1^3 - 123*S^2*b2^6 - 810*S^3*b1*b2^3 + 162*S^3*b1^2*b2 + 312*S^3*b2^5 - 945*S^4*b1*b2^2 + 270*S^4*b1^2 - 369*S^4*b2^4 - 108*S^5*b1*b2 - 684*S^5*b2^3 - 225*S^6*b2^2 - 756*b1*b2^6 + 1458*b1^2*b2^4 - 1026*b1^3*b2^2 + 243*b1^4;
# E2 = - E2Subst / E2Div;


### Classic Polynomial
# - see file: Poly.System.S3P3.Mega.ClassicPoly.R;
(3*b1*b2*y^3 + 2*b2^4*x^2 + 2*b1*b2^3*x - 2*b2^3*R - b1^3 - 3*b1*b2*R)^2 +
	+ (b2*y^3 - b1^2 - b2*R)^2*(4*b2*y^3 - b1^2 - 4*b2*R)
(3*b1^3*y - 3*b1*b2*(x^3 - R)*y + 3*b1^2*x^3 + 2*b2^5*x^2 + 2*b1*b2^4*x +
		- 3*b1^2*R - 2*b2^4*R - b1^3*b2 - 3*b1*b2^2*R)^2 +
	+ (b1^2*y - b2*(x^3-R)*y + b1*x^3 - b1^2*b2 - b1*R - b2^2*R)^2*(4*b2*y^3 - b1^2 - 4*b2*R)


### Debug
R = 2; b = c(-1, 3); b2=b[1]; b1 = b[2];
x = -0.84266687675 - 0.67429501628i;
y =  0.45452251454 + 0.54034691130i;
z =  1.75594150810 + 0.34602494638i;
S = x+y+z; E2 = x*y+x*z+y*z; E3 = x*y*z;


########################

########################
### Mixed Side-Chain ###
########################

### x[i]^3 + b2*x[j]^2 + b1*x[k]

# x^3 + b2*y^2 + b1*z = R
# y^3 + b2*z^2 + b1*x = R
# z^3 + b2*x^2 + b1*y = R


### Solution:

### Sum =>
(x^3 + y^3 + z^3) + b2*(x^2 + y^2 + z^2) + b1*S - 3*R # = 0
S^3 - 3*E2*S + 3*E3 + b2*(S^2 - 2*E2) + b1*S - 3*R # = 0
S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 + 3*E3 - 3*R # = 0
# 3*E3 = -(S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 - 3*R)

### Eq2:
# x^3 + b1*z = R - b2*y^2
# x^3 + b1*y + b1*z = R - b2*y^2 + b1*y # Sq =>
# (x^3 + b1*y + b1*z)^2 = (b2*y^2 - b1*y - R)^2
x^6 + b1^2*y^2 + b1^2*z^2 + 2*b1*x^3*y + 2*b1*x^3*z + 2*b1^2*y*z # =
	b2^2*y^4 + b1^2*y^2 + R^2 - 2*b1*b2*y^3 - 2*b2*R*y^2 + 2*b1*R*y
### Sum =>
(x^6+y^6+z^6) + 2*b1^2*(x^2+y^2+z^2) + 2*b1*(x^3*y+x^3*z+y^3*x+y^3*z+z^3*x+z^3*y) + 2*b1^2*E2 # =
	b2^2*(x^4+y^4+z^4) - 2*b1*b2*(x^3+y^3+z^3) + (b1^2 - 2*b2*R)*(x^2+y^2+z^2) + 2*b1*R*S + 3*R^2
### sum(x^3*y) = (x^2+y^2+z^2)*E2 - E3*S
- 3*E3^2 + 12*E2*E3*S - 6*E3*S^3 + 4*b2^2*E3*S + 2*b1*E3*S - 6*b1*b2*E3 +
	+ 2*E2^3 - 9*E2^2*S^2 + 2*b2^2*E2^2 + 4*b1*E2^2 +
	+ 6*E2*S^4 - 4*b2^2*E2*S^2 - 2*b1*E2*S^2 + 6*b1*b2*E2*S + 4*b2*R*E2 +
	- S^6 + b2^2*S^4 - 2*b1*b2*S^3 - 2*b2*R*S^2 - b1^2*S^2  + 2*b1*R*S + 3*R^2 # = 0

### Eq3:
# x^3 + b2*y^2 = R - b1*z
# x^3 + b2*y^2 + b2*z^2 = b2*z^2 - b1*z + R
# (x^3 + b2*y^2 + b2*z^2)^2 = (b2*z^2 - b1*z + R)^2
x^6 + 2*b2*x^3*y^2 + 2*b2*x^3*z^2 + b2^2*y^4 + b2^2*z^4 + 2*b2^2*y^2*z^2 # =
	b2^2*z^4 - 2*b1*b2*z^3 + b1^2*z^2 + 2*b2*R*z^2 - 2*b1*R*z + R^2
### Sum =>
(x^6+y^6+z^6) + 2*b2^2*(x^4+y^4+z^4) + 2*b2^2*(E2^2 - 2*E3*S) +
	+ 2*b2*(x^3*y^2+x^3*z^2+y^3*x^2+y^3*z^2+z^3*x^2+z^3*y^2) # =
	b2^2*(x^4+y^4+z^4) - 2*b1*b2*(x^3+y^3+z^3) + (b1^2 + 2*b2*R)*(x^2+y^2+z^2) - 2*b1*R*S + 3*R^2
### sum(x^3*y^2) = (E2^2 - 2*E3*S)*S - E3*E2
3*E3^2 - 12*E2*E3*S - 2*b2*E2*E3 + 6*E3*S^3 - 4*b2*E3*S^2 + 6*b1*b2*E3 +
	- 2*E2^3 + 9*E2^2*S^2 + 2*b2*E2^2*S + 4*b2^2*E2^2 +
	- 6*E2*S^4 - 4*b2^2*E2*S^2 - 6*b1*b2*E2*S + 2*b1^2*E2 + 4*b2*R*E2 +
	+ S^6 + b2^2*S^4 + 2*b1*b2*S^3 - b1^2*S^2 - 2*b2*R*S^2 + 2*b1*R*S - 3*R^2 # = 0
# Diff: Eq 2 - Eq 3 =>
b2*E2*E3 + 2*b2*E3*S^2 - 2*b2^2*E3*S - b1*E3*S +
	- b2*E2^2*S - 3*b2^2*E2^2 - 2*b1*E2^2 +
	+ 4*b2^2*E2*S^2 + b1*E2*S^2 - b1^2*E2 - 4*b2*R*E2 +
	- b2^2*S^4 + b1^2*S^2 + 2*b2*R*S^2 - 2*b1*R*S # = 0

# =>
# 3*E3 = -(S^3 + b2*S^2 + b1*S - 3*E2*S - 2*b2*E2 - 3*R)
pE3x3 = data.frame(
	E2 = c(0, 0, 0, 1, 1, 0),
	S  = c(3, 2, 1, 1, 0, 0),
	b1 = c(0, 0, 1, 0, 0, 0),
	b2 = c(0, 1, 0, 0, 1, 0),
	R  = c(0, 0, 0, 0, 0, 1),
	coeff = c(-1,-1,-1, 3, 2, 3)
)
p2 = data.frame(
	E3 = c(1, 1, 1, 1,   0, 0, 0,   0, 0, 0, 0,   0, 0, 0, 0),
	E2 = c(1, 0, 0, 0,   2, 2, 2,   1, 1, 1, 1,   0, 0, 0, 0),
	S  = c(0, 2, 1, 1,   1, 0, 0,   2, 2, 0, 0,   4, 2, 2, 1),
	b1 = c(0, 0, 0, 1,   0, 0, 1,   0, 1, 2, 0,   0, 2, 0, 1),
	b2 = c(1, 1, 2, 0,   1, 2, 0,   2, 0, 0, 1,   2, 0, 1, 0),
	R  = c(0, 0, 0, 0,   0, 0, 0,   0, 0, 0, 1,   0, 0, 1, 1),
	coeff = c(1, 2, -2,-1, -1,-3,-2,  4, 1,-1,-4, -1, 1, 2,-2)
)
p3 = data.frame(
	E3 = c(2, 1, 1, 1, 1, 1,   0, 0, 0, 0,   0, 0, 0, 0, 0,   0, 0, 0, 0, 0, 0, 0),
	E2 = c(0, 1, 1, 0, 0, 0,   3, 2, 2, 2,   1, 1, 1, 1, 1,   0, 0, 0, 0, 0, 0, 0),
	S  = c(0, 1, 0, 3, 2, 0,   0, 2, 1, 0,   4, 2, 1, 0, 0,   6, 4, 3, 2, 2, 1, 0),
	b1 = c(0, 0, 0, 0, 0, 1,   0, 0, 0, 0,   0, 0, 1, 2, 0,   0, 0, 1, 2, 0, 1, 0),
	b2 = c(0, 0, 1, 0, 1, 1,   0, 0, 1, 2,   0, 2, 1, 0, 1,   0, 2, 1, 0, 1, 0, 0),
	R  = c(0, 0, 0, 0, 0, 0,   0, 0, 0, 0,   0, 0, 0, 0, 1,   0, 0, 0, 0, 1, 1, 2),
	coeff = c(3,-12,-2,6,-4,6,  -2, 9, 2, 4,  -6,-4,-6, 2, 4,  1, 1, 2,-1,-2, 2,-3)
)
# Debug
eval.pm(p2, c(E3, E2, S, b1, b2, R))
eval.pm(p3, c(E3, E2, S, b1, b2, R))

### Solve:
p2r = replace.fr.pm(p2, p1, 3, "E3", 1)
p2r$coeff = - p2r$coeff;
p2r = sort.pm(p2r, c(4,5,3), xn=c("E2","S"))

p3r = replace.fr.pm(p3, p1, 3, "E3", 1)
p3r$coeff = - p3r$coeff / 6;
p3r = sort.pm(p3r, c(4,5,3), xn=c("E2","S"))

7*b2^2*E2^2 + 6*b1*E2^2 - 5*S^3*b2*E2 - 9*S^2*b2^2*E2 + 4*S*b2^3*E2 + 3*S*b1*b2*E2 + 3*b1^2*E2 + 9*b2*R*E2 +
	+ 2*S^5*b2 + 3*S^4*b2^2 - S^4*b1 - 2*S^3*b2^3 + S^3*b1*b2 - 2*S^2*b1*b2^2 - 4*S^2*b1^2 +
	- 12*S^2*b2*R + 6*S*b2^2*R + 9*S*b1*R

3*E2^3 + 6*S*b2*E2^2 - 6*b2^2*E2^2 - 3*S^4*E2 - 2*S^3*b2*E2 - 3*S^2*b1*E2 + 11*S^2*b2^2*E2 +
	+ S*b1*b2*E2 + 9*S*R*E2 - 3*b1^2*E2 - 6*b1*b2^2*E2 - 9*b2*R*E2 +
	+ S^6 + 2*S^4*b1 - 4*S^4*b2^2 - 3*S^3*b1*b2 - 6*S^3*R +
	+ S^2*b1^2 + 3*S^2*b1*b2^2 + 12*S^2*b2*R + 3*S*b1^2*b2 - 9*b1*b2*R

pS = solve.pm(p2r, p3r, "E2")

library(gmp)
pSr = pS[[1]]; pSr$coeff = as.bigz(pSr$coeff);
pDiv = data.frame(
	S=c(3,2,1,0), b2=c(0,1,0,0), b1=c(0,0,1,0), R=c(0,0,0,1),
	coeff=c(1, 3, 9, -27));
pDivInt = pDiv;
pDiv$coeff = as.bigz(pDiv$coeff);
pSd = div.bigpm(pSr, pDiv, by="S")
pSd = pSd[[1]];

pSd$coeff = - as.numeric(pSd$coeff)
pSd = sort.pm(pSd, c(4,3), xn=c("S"))
pSd
eval.pm(pSd, c(S, b1, b2, R))
# toCoeff(pSd, "S")

### True Solutions
### P[12] = P[4] * P[8];
b2^3*S^4 - b2^2*(3*b1 - 2*b2^2)*S^3 - 3*b1*b2^3*S^2 +
	+ (3*b1^3 + 3*b1^2*b2^2 - 6*b2^3*R + 4*b1*b2^4)*S +
	- 3*b1^3*b2 + 9*b1*b2^2*R - 7*b1^2*b2^3
p4non = data.frame(
	S  = c(4, 3, 3, 2,   1, 1, 1, 1,   0, 0, 0),
	b1 = c(0, 1, 0, 1,   3, 2, 0, 1,   3, 1, 2),
	b2 = c(3, 2, 4, 3,   0, 2, 3, 4,   1, 2, 3),
	R  = c(0, 0, 0, 0,   0, 0, 1, 0,   0, 1, 0),
	coeff = c(1,-3, 2,-3,  3, 3,-6, 4,  -3, 9,-7)
)
### The True Solutions:
pSd2 = div.pm(pSd, p4non, by="S")$Rez;
pSd2 = div.pm(pSd2, data.frame(b1=c(2,1,0), b2=c(0,2,4), coeff=c(108,252,147)), by="b2")$Rez;
pSd2 = sort.pm(pSd2, c(4,3), xn=c("S"))
# cat(paste(toCoeff(pSd2, "S"), sep="", collapse=",\n")); cat("\n");


### Auxiliary Eqs:
pE2x = pS[[2]];
pE2x$coeff = as.numeric(pE2x$coeff)
pE2x = sort.pm(pE2x, c(4,3), xn=c("S"))
# cat(paste(toCoeff(pE2x, "S"), sep="", collapse=",\n")); cat("\n");

pE2Div = pS[[3]];
pE2Div$coeff = as.numeric(pE2Div$coeff)
pE2Div = sort.pm(pE2Div, c(4,3), xn=c("S"))
# cat(paste(toCoeff(pE2Div, "S"), sep="", collapse=",\n")); cat("\n");

### Test:
x^3 + b2*y^2 + b1*z # - R
y^3 + b2*z^2 + b1*x # - R
z^3 + b2*x^2 + b1*y # - R

### Debug:
R = 3; b = c(2,-1);
b1 = b[1]; b2 = b[2];
x = -1.6372723783 + 0.4783895464i;
y = -1.0979358419 - 1.8696543548i;
z =  1.9873630466 + 0.1839016351i;
S = x+y+z; E2 = x*y+x*z+y*z; E3 = x*y*z;


