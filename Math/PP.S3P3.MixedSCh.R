########################
###
### Leonard Mada


### S3P3 with Mixed side Chain
# x^3 + b2*y^2 + b1*z = R;

coeff.S3P3.MixedSideChain = function(R, b) {
	b1 = b[1]; b2 = b[2]; R = R[1];
	# formula for coeff's is in reverse order;
	# but return(rev(coeff))!
	coeff = c(7203*b1^2*b2^12*R - 14406*b1^4*b2^11 - 9261*b1*b2^11*R^2 + 61740*b1^3*b2^10*R - 2916*b1^9*b2 - 50421*b1^5*b2^9 - 79380*b1^2*b2^9*R^2 - 19764*b1^8*b2^3 + 127008*b1^4*b2^8*R + 35721*b1*b2^8*R^3 - 53109*b1^7*b2^5 - 72324*b1^6*b2^7 +
		+ 8748*b1^7*b2^2*R - 127575*b1^3*b2^7*R^2 + 47628*b1^6*b2^4*R + 111699*b1^5*b2^6*R + 61236*b1^2*b2^6*R^3 - 8748*b1^5*b2^3*R^2 - 67068*b1^4*b2^5*R^2 + 26244*b1^3*b2^4*R^3,
	- 4116*b1*b2^13*R + 15435*b1^3*b2^12 + 6174*b2^12*R^2 - 45570*b1^2*b2^11*R + 56154*b1^4*b2^10 + 47628*b1*b2^10*R^2 + 2916*b1^9 - 93303*b1^3*b2^9*R - 23814*b2^9*R^3 + 16200*b1^8*b2^2 + 87087*b1^5*b2^8 + 83916*b1^2*b2^8*R^2 + 44145*b1^7*b2^4 +
		+ 8748*b1^7*b2*R - 55323*b1^4*b2^7*R - 76545*b1*b2^7*R^3 + 77193*b1^6*b2^6 + 31104*b1^6*b2^3*R + 42525*b1^3*b2^6*R^2 + 19035*b1^5*b2^5*R - 8748*b1^5*b2^2*R^2 - 78732*b1^2*b2^5*R^3 - 8748*b1^4*b2^4*R^2 - 26244*b1^3*b2^3*R^3,
	- 11319*b1^2*b2^13 + 17346*b1*b2^12*R - 48363*b1^3*b2^11 + 1764*b2^11*R^2 + 38262*b1^2*b2^10*R - 71631*b1^4*b2^9 + 9639*b1*b2^9*R^2 - 1620*b1^8*b2 - 58194*b1^3*b2^8*R +
		+ 23814*b2^8*R^3 - 10692*b1^7*b2^3 - 54120*b1^5*b2^7 - 8748*b1^7*R + 56295*b1^2*b2^7*R^2 - 28377*b1^6*b2^5 - 45684*b1^6*b2^2*R - 174798*b1^4*b2^6*R + 76545*b1*b2^6*R^3 - 133731*b1^5*b2^4*R - 17496*b1^5*b2*R^2 + 55890*b1^3*b2^5*R^2 - 8748*b1^4*b2^3*R^2 + 78732*b1^2*b2^4*R^3 + 26244*b1^3*b2^2*R^3,
	4116*b1*b2^14 - 8232*b2^13*R + 28959*b1^2*b2^12 - 26166*b1*b2^11*R + 51009*b1^3*b2^10 - 4410*b2^10*R^2 + 58401*b1^2*b2^9*R + 1296*b1^8 + 33249*b1^4*b2^8 +
		- 67095*b1*b2^8*R^2 - 864*b1^7*b2^2 + 211140*b1^3*b2^7*R - 23814*b2^7*R^3 - 7848*b1^6*b2^4 + 1116*b1^5*b2^6 + 23328*b1^6*b2*R - 129114*b1^2*b2^6*R^2 + 108864*b1^5*b2^3*R + 221292*b1^4*b2^5*R + 8748*b1^5*R^2 - 40824*b1*b2^5*R^3 + 2916*b1^4*b2^2*R^2 - 72657*b1^3*b2^4*R^2 - 17496*b1^2*b2^3*R^3,
	- 8085*b1*b2^13 + 2793*b2^12*R - 17976*b1^2*b2^11 - 26082*b1*b2^10*R - 5646*b1^3*b2^9 + 19845*b2^9*R^2 - 98496*b1^2*b2^8*R - 5832*b1^7*b2 - 9387*b1^4*b2^7 +
		+ 57834*b1*b2^7*R^2 - 27540*b1^6*b2^3 - 8748*b1^6*R - 92421*b1^3*b2^6*R - 35046*b1^5*b2^5 - 11664*b1^5*b2^2*R + 55404*b1^2*b2^5*R^2 - 26487*b1^4*b2^4*R + 17496*b1^3*b2^3*R^2,
	2058*b2^14 + 4263*b1*b2^12 + 4704*b2^11*R - 13692*b1^2*b2^10 + 34965*b1*b2^9*R - 7692*b1^3*b2^8 + 3969*b2^8*R^2 + 5832*b1^7 + 9882*b1^2*b2^7*R + 21060*b1^6*b2^2 +
		+ 32319*b1^4*b2^6 - 5103*b1*b2^6*R^2 + 40014*b1^5*b2^4 - 29160*b1^4*b2^3*R - 48276*b1^3*b2^5*R - 8748*b1^3*b2^2*R^2 - 17496*b1^2*b2^4*R^2,
	- 441*b2^13 + 7917*b1*b2^11 - 12936*b2^10*R + 10134*b1^2*b2^9 - 1008*b1*b2^8*R - 6774*b1^3*b2^7 + 3969*b2^7*R^2 - 1944*b1^6*b2 - 8640*b1^5*b2^3 - 15462*b1^4*b2^5 + 5832*b1^4*b2^2*R + 29160*b1^3*b2^4*R + 34722*b1^2*b2^6*R + 2916*b1^2*b2^3*R^2 + 6804*b1*b2^5*R^2,
	- 1029*b2^12 - 3822*b1*b2^10 - 5733*b2^9*R + 5124*b1^2*b2^8 - 972*b1^6 - 8100*b1^5*b2^2 - 8019*b1^4*b2^4 + 6678*b1^3*b2^6 - 1944*b1^3*b2^3*R - 8748*b1^2*b2^5*R - 12474*b1*b2^7*R,
	2205*b2^11 - 3864*b1*b2^9 - 648*b1^5*b2 + 3240*b1^4*b2^3 + 4590*b1^3*b2^5 - 5016*b1^2*b2^7 + 972*b1^3*b2^2*R + 2916*b1^2*b2^4*R + 2835*b1*b2^6*R + 882*b2^8*R,
	1764*b2^10 + 324*b1^5 + 2052*b1^4*b2^2 + 1953*b1^3*b2^4 - 468*b1^2*b2^6 + 966*b1*b2^8 - 648*b1^2*b2^3*R - 1512*b1*b2^5*R - 882*b2^7*R,
	- 324*b1^3*b2^3 - 756*b1^2*b2^5 - 441*b1*b2^7,
	- 324*b1^3*b2^2 - 648*b1^2*b2^4 - 189*b1*b2^6 + 147*b2^8,
	108*b1^2*b2^3 + 252*b1*b2^5 + 147*b2^7);
	return(rev(coeff));
}

E2.S3P3.MixedSideChain = function(S, R, b) {
	coeff = c(- 441*b1*b2^5*R - 324*b1^3*b2*R - 756*b1^2*b2^3*R,
		252*b2^6*R + 147*b1^2*b2^5 + 108*b1^4*b2 + 594*b1*b2^4*R + 252*b1^3*b2^3 +
			+ 81*b1^3*R + 162*b2^3*R^2 + 378*b1^2*b2^2*R + 243*b1*b2*R^2,
		63*b1*b2^6 - 96*b2^5*R + 61*b1^2*b2^4 + 30*b1^3*b2^2 + 90*b1*b2^3*R - 27*b1^2*b2*R - 324*b2^2*R^2,
		- 84*b2^7 - 117*b1*b2^5 - 150*b2^4*R + 9*b1^3*b2 - 60*b1^2*b2^3 - 216*b1^2*R - 396*b1*b2^2*R,
		- 10*b2^6 + 63*b1^3 + 96*b1^2*b2^2 - 94*b1*b2^4 - 162*b1*b2*R + 315*b2^3*R,
		105*b1^2*b2 + 24*b1*b2^3 + 48*b2^5 + 234*b2^2*R,
		36*b1^2 + 42*b1*b2^2 - 62*b2^4,
		15*b1*b2 - 99*b2^3,
		- 30*b2^2);
	E2 = sum(coeff * S^seq(0, 8));
	# DIV
	coeff = c(294*b1*b2^6 + 63*b2^5*R + 81*b1^4 + 525*b1^2*b2^4 + 360*b1^3*b2^2 +
			+ 432*b1*b2^3*R + 162*b1^2*b2*R - 243*b2^2*R^2,
		- 168*b2^7 - 319*b1*b2^5 - 153*b2^4*R + 18*b1^3*b2 - 138*b1^2*b2^3 - 162*b1^2*R - 297*b1*b2^2*R,
		- 41*b2^6 - 297*b1*b2^4 + 36*b1^3 + 234*b2^3*R - 21*b1^2*b2^2 - 216*b1*b2*R,
		104*b2^5 + 180*b1^2*b2 + 171*b1*b2^3 + 270*b2^2*R,
		90*b1^2 + 195*b1*b2^2 - 123*b2^4,
		36*b1*b2 - 228*b2^3,
		- 75*b2^2);
	pDiv = sum(coeff * S^seq(0, 6));
	return(E2 / pDiv);
}
