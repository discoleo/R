########################
###
### Leonard Mada
### [the one and only]
###
### Polynomial Systems: S2
### Heterogenous Symmetric
###
### Derivation of Formulas
###
### draft v.0.3a-clean3


### Systems:
# - are described in file:
#   Poly.System.Hetero.Symmetric.R;

# this file contains the detailed derivations;


####################
####################

### helper functions

library(polynom)
library(pracma)

# the functions are in the file:
# Polynomials.Helper.R;
# e.g. round0(), round0.p;


##########################

##########################
### Polynomial Systems ###
##########################

###############
### Order 3 ###
###############

### x^3 + b*y

# x^3 + b1*y = R
# y^3 + b1*x = R

### Extensions:
# E1: x^3 + b2*x*y + b1*y = R; [P3 => P6]
# E2: x^3 + b3*(x*y)^2 + b2*x*y + b1*y = R; [P4 => P8]
# - are discussed in a separate section;

### Solution:

### Diff =>
# x^3 - y^3 - b1*(x-y) = 0
# (x - y)*(x^2 + y^2 + x*y - b1) = 0
# => x = y *OR* x^2 + y^2 + x*y - b1 = 0;
# =>
# (x+y)^2 - x*y - b1 = 0
# x*y = (x+y)^2 - b1;
# x*y = S^2 - b1;

### Sum =>
# (x+y)^3 - 3*x*y*(x+y) + b1*(x+y) = 2*R
# S^3 - 3*(S^2 - b1)*S + b1*S - 2*R = 0
# S^3 - 2*b1*S + R = 0

### Classic Polynomial:
### Derivation:
# b1*y = R - x^3
# =>
# (R - x^3)^3 / b1^3 + b1*x - R = 0
# (R - x^3)^3 + b1^4*x - R*b1^3
# (x^3 - R)^3 - b1^4*x + R*b1^3
# (x^3 + b1*x - R - b1*x)^3 - b1^4*x + R*b1^3
# (x^3 + b1*x - R)^3 - 3*b1*x*(x^3 + b1*x - R)^2 + 3*b1^2*x^2*(x^3 + b1*x - R) - b1^3*x^3 - b1^4*x + R*b1^3
# let: p = (x^3 + b1*x - R)
# p^3 - 3*b1*x*p^2 + 3*b1^2*x^2*p - b1^3*p
# p*(p^2 - 3*b1*x*p + 3*b1^2*x^2 - b1^3)
# (x^3 + b1*x - R)*(x^6 - b1*x^4 - 2*R*x^3 + b1^2*x^2 + b1*R*x + R^2 - b1^3)
# =>
(x^3 - b[1]/2 * x - R)^2 + 3/4 * b[1]^2*x^2 - b[1]^3

err = x^6 - b[1]*x^4 - 2*R*x^3 + b[1]^2*x^2 + b[1]*R*x + R^2 - b[1]^3
round0(err)

#####################

#####################
### Shifted Roots ###
#####################

### (x - s)^3 + b*y

# (x - s)^3 + b1*y = R
# (y - s)^3 + b1*x = R

### Solution:
# - direct solution possible based on the simple (unshifted) system;

### [old/initial Derivation]
### Diff =>
# (x - s)^3 - (y - s)^3 - b1*(x-y) = 0
# (x - y)*(x^2 + x*y + y^2 - 3*s*(x+y) + 3*s^2 - b1) = 0
# => x = y *OR* x^2 + x*y + y^2 - 3*s*(x+y) + 3*s^2 - b1 = 0;
# =>
(x+y)^2 - 3*s*(x+y) - x*y + 3*s^2 - b1 # = 0
# x*y = (x+y)^2 - 3*s*(x+y) + 3*s^2 - b1;
# x*y = Z^2 - 3*s*Z + 3*s^2 - b1;

### Sum =>
# (x - s)^3 + (y - s)^3 + b1*(x+y) = 2*R
(x+y)^3 - 3*x*y*(x+y) - 3*s*(x^2+y^2) + (3*s^2+b1)*(x+y) - 2*s^3 - 2*R # = 0
Z^3 - 3*s*Z^2 - 3*x*y*Z + 6*s*x*y + (3*s^2+b1)*Z - 2*s^3 - 2*R
Z^3 - 3*s*Z^2 - 3*(Z^2 - 3*s*Z + 3*s^2 - b1)*Z + 6*s*(Z^2 - 3*s*Z + 3*s^2 - b1) + (3*s^2+b1)*Z - 2*s^3 - 2*R
-2*Z^3 + 12*s*Z^2 + 4*(b1-6*s^2)*Z + 16*s^3 - 2*R - 6*s*b1
Z^3 - 6*s*Z^2 - 2*(b1-6*s^2)*Z - 8*s^3 + R + 3*s*b1

### Classic Polynomial
### Derivation:
# b1*y = R - (x-s)^3
# =>
# (R - (x-s)^3 - s*b1)^3 / b1^3 + b1*x - R = 0
# (R - (x-s)^3 - s*b1)^3 + b1^4*x - R*b1^3
# ((x-s)^3 - R + s*b1)^3 - b1^4*x + R*b1^3
# ((x-s)^3 - R + b1*x - b1*x + s*b1)^3 - b1^4*x + R*b1^3 # p = ((x-s)^3 - R + b1*x)
# ((x-s)^3 - R + b1*x)*(p^2 - 3*(b1*x - s*b1)*p + 3*(b1*x - s*b1)^2) - (b1*x - s*b1)^3 - b1^4*x + R*b1^3
# p*(p^2 - 3*(b1*x - s*b1)*p + 3*(b1*x - s*b1)^2) - b1^3 * ((x-s)^3 + b1*x - R)
# p*(p^2 - 3*(b1*x - s*b1)*p + 3*(b1*x - s*b1)^2 - b1^3)
# p == 0 *OR* 2nd (...) == 0, where p = ((x-s)^3 - R + b1*x)
# p^2 - 3*b1*(x - s)*p + 3*b1^2*(x - s)^2 - b1^3 == 0
# (x-s)^6 + b1^2*x^2 + R^2 + 2*b1*x*(x-s)^3 - 2*R*(x-s)^3 - 2*b1*R*x - 3*b1*(x - s)*p + 3*b1^2*(x - s)^2 - b1^3
# (x-s)^6 + 2*b1*x*(x-s)^3 - 2*R*(x-s)^3 - 3*b1*(x - s)*p + b1^2*x^2 + 3*b1^2*(x - s)^2 - 2*b1*R*x + R^2 - b1^3
# (x-s)^6 + 2*b1*x*(x-s)^3 - 2*R*(x-s)^3 - 3*b1*(x-s)^4 - 3*b1^2*(x-s)*x + 4*b1^2*x^2 + 3*b1*R*(x-s) - 6*b1^2*s*x + 3*b1^2*s^2 - 2*b1*R*x + R^2 - b1^3
# (x-s)^6 - 3*b1*(x-s)^4 + 2*b1*x*(x-s)^3 - 2*R*(x-s)^3 + b1^2*x^2 - 3*b1^2*s*x + b1*R*x - 3*b1*R*s + 3*b1^2*s^2 + R^2 - b1^3
# (x-s)^6 - 3*b1*(x-s)^4 + 2*b1*x*(x-s)^3 - 2*R*x^3 + 6*R*s*x^2 + b1^2*x^2 - 6*R*s^2*x - 3*b1^2*s*x + b1*R*x - 3*b1*R*s + 3*b1^2*s^2 + 2*R*s^3 + R^2 - b1^3
# (x-s)^6 - (b1*x - 3*b1*s)*(x-s)^3 - 2*R*x^3 + 6*R*s*x^2 + b1^2*x^2 - 6*R*s^2*x - 3*b1^2*s*x + b1*R*x - 3*b1*R*s + 3*b1^2*s^2 + 2*R*s^3 + R^2 - b1^3
# (x-s)^6 - (b1*x - 3*b1*s)*(x-s)^3 - 2*R*x^3 + (6*R*s + b1^2)*x^2 - (6*R*s^2 + 3*b1^2*s - b1*R)*x - 3*b1*R*s + 3*b1^2*s^2 + 2*R*s^3 + R^2 - b1^3
#
# (x-s)^6 - b1*x^4 + (6*b1*s - 2*R)*x^3 - (12*b1*s^2 - 6*R*s - b1^2)*x^2 + (10*b1*s^3 - 6*R*s^2 - 3*b1^2*s + b1*R)*x - 3*b1*R*s + 3*b1^2*s^2 + 2*R*s^3 - 3*b1*s^4 + R^2 - b1^3


#######################
#######################

###################
### x^3 + b*x*y ###

# x^3 + b1*x*y = R
# y^3 + b1*x*y = R

### Solution:

### Diff =>
x^3 - y^3 # = 0
(x-y)*(x^2 + x*y + y^2) # = 0
# Case 2:
x^2 + x*y + y^2 # = 0
# x*y = (x + y)^2

### Sum =>
# x^3 + y^3 + 2*b1*x*y - 2*R = 0
# (x+y)^3 - 3*x*y*(x+y) + 2*b1*x*y - 2*R
# Z^3 - 3*Z^3 + 2*b1*Z^2 - 2*R
# Z^3 - b1*Z^2 + R

### Classic Polynomial

### Derivation
# b1*y = (R - x^3) / x
(b[1]*y)^3 + b[1]^4*x*y - R*b[1]^3
(R - x^3)^3 / x^3 + b[1]^3*x*(R - x^3) / x - R*b[1]^3
(R - x^3)^3 + b[1]^3*x^3*(R - x^3) - R*b[1]^3*x^3
(x^3 - R)^3 + b[1]^3*x^6
(x^3 + b[1]*x^2 - R)*((x^3 - R)^2 - b[1]*x^2*(x^3 - R) + b[1]^2*x^4)
# =>
x^6 - b[1]*x^5 + b[1]^2*x^4 - 2*R*x^3 + b[1]*R*x^2 + R^2
(x^3 - b[1]/2*x^2 - R)^2 + 3/4 * b[1]^2*x^4 # relatively trivial


#################
### Shifted Roots

### (x - s)^3 + b*x*y

# (x-s)^3 + b1*x*y = R
# (y-s)^3 + b1*x*y = R

### Solution:

### Diff =>
(x-s)^3 - (y-s)^3 # = 0
(x-y)*((x-s)^2 + (x-s)*(y-s) + (y-s)^2) # = 0
# alternatively: x - s = (y-s)*m, where m^3 = 1;
# Case: x != y
# (x-s)^2 + (x-s)*(y-s) + (y-s)^2 = 0
# (x+y - 2*s)^2 = (x-s)*(y-s)
# x*y = (x+y - 2*s)^2 + s*(x+y) - s^2
# x*y = (Z - 2*s)^2 + s*Z - s^2
# x*y = Z^2 - 3*s*Z + 3*s^2

### Sum =>
(x-s)^3 + (y-s)^3 + 2*b1*x*y - 2*R # = 0
(x+y)^3 - 3*x*y*(x+y) - 3*s*(x^2+y^2) + 3*s^2*(x+y) + 2*b1*x*y - 2*R - 2*s^3
Z^3 - 3*s*(Z^2 - 2*x*y) + 3*s^2*Z - 3*x*y*Z + 2*b1*x*y - 2*R - 2*s^3
Z^3 - 3*s*Z^2 + 3*s^2*Z - 3*x*y*Z + 6*s*x*y + 2*b1*x*y - 2*R - 2*s^3
Z^3 - 3*s*Z^2 + 3*s^2*Z -3*Z*(Z^2 - 3*s*Z + 3*s^2) + (6*s+2*b1)*(Z^2 - 3*s*Z + 3*s^2) - 2*R - 2*s^3
Z^3 - (6*s+b1)*Z^2 + (12*s^2+3*b1*s)*Z - 8*s^3 - 3*b1*s^2 + R

### Classic Polynomial:
### Derivation:
# y - s = (x-s)*m, where m^3 = 1;
# =>
# (x-s)^3 + b1*x*(s + (x-s)*m) = R
# (x-s)^3 + b1*x*(x-s)*m + b1*s*x - R = 0
round0((x-s)^3 + b[1]*x*(x-s)*m^1 + b[1]*s*x - R)
((x-s)^3 + b[1]*x*(x-s)*m^1 + b[1]*s*x - R)*((x-s)^3 + b[1]*x*(x-s)*m^2 + b[1]*s*x - R)
# back-shifted:
(x^3 + b[1]*x^2*m^1 - b[1]*s*x*m^2 + b[1]*s^2 - R)*(x^3 + b[1]*x^2*m^2 - b[1]*s*x*m + b[1]*s^2 - R)


######################
######################

######################
### xy & x/y-Terms ###
######################

### x-Term
### x^3 + b2*x*y + b1*x
# x-Terms vs y-Terms: are equivalent;

# x^3 + b2*x*y + b1*x = R
# y^3 + b2*x*y + b1*y = R

### Solution:

### Diff =>
x^3 - y^3 + b1*(x - y) # = 0
(x-y)*(x^2 + x*y + y^2 + b1) # = 0
# Case: x != y
# x^2 + x*y + y^2 + b1 = 0
# x*y = (x + y)^2 + b1
# x*y = Z^2 + b1

### Sum =>
x^3 + y^3 + 2*b2*x*y + b1*(x+y) - 2*R # = 0
(x+y)^3 - 3*x*y*(x+y) + 2*b2*x*y + b1*(x+y) - 2*R
Z^3 - 3*x*y*Z + 2*b2*x*y + b1*Z - 2*R
Z^3 - 3*Z^3 - 3*b1*Z + 2*b2*Z^2 + 2*b2*b2 + b1*Z - 2*R
Z^3 - b2*Z^2 + b1*Z - b1*b2 + R

### Classic Polynomial:

### Derivation:
# Z^3 - b2*Z^2 + b1*Z - b1*b2 + R
# x[1]+x[2]+x[3]+x[4]+x[5]+x[6] = b2;
# (x[1]+x[4])*(x[2]+x[5]+x[3]+x[6]) + (x[2]+x[5])*(x[3]+x[6]) = b1
# x[1]*(x[2]+x[3] + 0 +x[5]+x[6]) + x[2]*(x[3]+x[4] + 0 + x[6]) +
#   + x[3]*(x[4]+x[5] + 0) + x[4]*(x[5]+x[6]) + x[5]*x[6] = b1;
# (x[1]+x[4])*(x[2]+x[5])*(x[3]+x[6]) = b[1]*b[2] - R
# E2 = b[1] + x[1]*x[4] + x[2]*x[5] + x[3]*x[6]
#    = b[1] + (x[1]+x[4])^2 + (x[2]+x[5])^2 + (x[3]+x[6])^2 + 3*b[1]
#    = 4*b[1]+ b[2]^2 - 2*b[1]
#    = 2*b1] + b[2]^2;
# E3 = x[1]*x[2]*(x[3]+_x[4]+_x[5]+x[6]) + x[1]*x[3]*(_x[4]+x[5]+_x[6]) + x[1]*x[4]*(_x[5]+_x[6]) + x[1]*x[5]*x[6] +
#    + x[2]*x[3]*(x[4]+_x[5]+_x[6]) + x[2]*x[4]*(_x[5]+x[6]) + _x[2]*x[5]*x[6] +
#    + x[3]*x[4]*(x[5]+_x[6]) + _x[3]*x[5]*x[6] + x[4]*x[5]*x[6]
#    = x[1]*x[4]*(x[2]+x[3]+x[5]+x[6]) + x[2]*x[5]*(x[1]+x[3]+x[4]+x[6]) + x[3]*x[6]*(x[1]+x[2]+x[4]+x[5])
#      + (x[1]+x[4])*(x[2]+x[5])*(x[3]+x[6])
#    = (S1^2 + b[1])*(b[2] - S1) + ...
#    = -S1^3 + b[2]*S1^2 - b[1]*S1 + b[1]*b[2] + ... # Note: Sum = + 3*b[1]*b[2]
#    = -(b[2]^3 - 3*b[1]*b[2] + 3*(b[1]*b[2] - R)) + b[2]*(b[2]^2 - 2*b[1]) - b[1]*b[2] + 3*b[1]*b[2] + b[1]*b[2] - R
#    = b[1]*b[2] + 2*R
# E6 = (S1^2 + b[1])*(S2^2 + b[1])*(S3^2 + b[1])
#    = (S1^2*S2^2 + b[1]*(S1^2 + S2^2) + b[1]^2)*(S3^2 + b[1])
#    = (S1*S2*S3)^2 + b[1]^2*(S1^2 + S2^2 + S3^2) + b[1]*(S1^2*S2^2 + S1^2*S3^2 + S2^2*S3^2) + b[1]^3
#    = (b[1]*b[2] - R)^2 + b[1]^2*(b[2]^2 - 2*b[1]) + b[1]*(b[1]^2 - 2*b[2]*(b[1]*b[2] - R)) + b[1]^3
#    = R^2
# E5 = S1*(S2^2 + b[1])*(S3^2 + b[1]) + S2*(S1^2 + b[1])*(S3^2 + b[1]) + S3*(S1^2 + b[1])*(S2^2 + b[1])
#    = S1*S2^2*S3^2 + b[1]*S1*(S2^2 + S3^2) + b[1]^2*S1 + ...
#    = S1*S2*S3*E2 + b[1]^2*(S1+S2+S3) + b[1]*(S1*S2^2 + S1*S3^2 + S2*S1^2 + S2*S3^2 + S3*S1^2 + S3*S2^2)
#    = b[1]*(b[1]*b[2] - R) + b[1]^2*b[2] + b[1]*(b[2]*b[1] - 3*(b[1]*b[2] - R))
#    = 2*b[1]*R
# E4 = x[1]*x[4]*(x[2]+x[5])*(x[3]+x[6]) + x[2]*x[5]*(x[1]+x[4])*(x[3]+x[6]) + x[3]*x[6]*(x[1]+x[4])*(x[2]+x[5]) +
#      + x[1]*x[2]*x[4]*x[5] + x[1]*x[3]*x[4]*x[6] + x[2]*x[3]*x[5]*x[6]
#    = S2*S3*(S1^2 + b[1]) + S1*S3*(S2^2 + b[1]) + S1*S2*(S3^2 + b[1]) +
#      + (S1^2 + b[1])*(S2^2 + b[1]) + (S1^2 + b[1])*(S3^2 + b[1]) + (S2^2 + b[1])*(S3^2 + b[1])
#    = E3*(S1 + S2 + S3) + b[1]*E2 + (S1^2*S2^2 + ... + 2*b[1]*(S1^2 + S2^2 + S3^2) + 3*b[1]^2)
#    = b[2]*(b[1]*b[2] - R) + b[1]^2 + (E2^2 - 2*E3*(S1 + S2 + S3)) + 2*b[1]*(b[2]^2 - 2*b[1]) + 3*b[1]^2
#    = 3*b[1]*b[2]^2 - R*b[2] + b[1]^2 - 2*(b[1]*b[2] - R)*b[2]
#    = b[1]*b[2]^2 + R*b[2] + b[1]^2
x^6 - b[2]*x^5 + (b[2]^2 + 2*b[1])*x^4 - (b[1]*b[2] + 2*R)*x^3 + (b[1]*b[2]^2 + R*b[2] + b[1]^2)*x^2 - 2*b[1]*R*x + R^2


###############

###############
### y-Term ####

### x^3 + b2*x*y + b1*y

# x^3 + b2*x*y + b1*y = R
# y^3 + b2*x*y + b1*x = R

### Solution:

### Diff =>
x^3 - y^3 - b1*(x - y) # = 0
(x-y)*(x^2 + x*y + y^2 - b1) # = 0
# Case: x != y
# x^2 + x*y + y^2 - b1 = 0
# x*y = (x + y)^2 - b1

### Sum =>
x^3 + y^3 + 2*b2*x*y + b1*(x+y) - 2*R # = 0
(x+y)^3 - 3*x*y*(x+y) + 2*b2*x*y + b1*(x+y) - 2*R
Z^3 - 3*x*y*Z + 2*b2*x*y + b1*Z - 2*R
Z^3 - 3*Z^3 + 3*b1*Z + 2*b2*Z^2 - 2*b2*b2 + b1*Z - 2*R
Z^3 - b2*Z^2 - 2*b1*Z + b1*b2 + R


################################
### x^3 + b3*x*y + b2*y^2 + b1*y

# x^3 + b3*x*y + b2*y^2 + b1*y = R
# y^3 + b3*x*y + b2*x^2 + b1*x = R

### Solution:

### Diff =>
x^3 - y^3 - b2*(x^2 - y^2) - b1*(x - y) # = 0
(x-y)*(x^2 + y^2 + x*y - b2*(x+y) - b1) # = 0
# Case: x != y
# x^2 + y^2 + x*y - b2*(x+y) - b1 = 0
# x*y = (x + y)^2 - b2*(x+y) - b1
# x*y = S^2 - b2*S - b1

### Sum =>
S^3 - 3*x*y*S + 2*b3*x*y + b2*S^2 - 2*b2*x*y + b1*S - 2*R # = 0
S^3 - 3*S^3 + 3*b2*S^2 + 3*b1*S + 2*b3*S^2 - 2*b2*b3*S - 2*b1*b3 +
	+ b2*S^2 - 2*b2*S^2 + 2*b2^2*S + 2*b1*b2 + b1*S - 2*R # = 0
-2*S^3 + 2*b2*S^2 + 2*b3*S^2 + 4*b1*S - 2*b2*b3*S + 2*b2^2*S + 2*b1*b2 - 2*b1*b3 - 2*R
S^3 - (b2 + b3)*S^2 - (2*b1 - b2*b3 + b2^2)*S - b1*b2 + b1*b3 + R


### Classic Polynomial:

### Derivation
# S^3 - (b[2] + b[3])*S^2 - (2*b[1] - b[2]*b[3] + b[2]^2)*S - b[1]*b[2] + b[1]*b[3] + R
# x*y = S^2 - b2*S - b1

# E1 = b[2] + b[3]
# E2 = - (2*b[1] - b[2]*b[3] + b[2]^2) + (S1^2 + S2^2 + S3^2) - b[2]*E1 - 3*b[1]
#    = - (2*b[1] - b[2]*b[3] + b[2]^2) + E1^2 - 2*E2_P3 - b[2]*E1 - 3*b[1]
#    = - (2*b[1] - b[2]*b[3] + b[2]^2) + E1^2 + 2*(2*b[1] - b[2]*b[3] + b[2]^2) - b[2]*E1 - 3*b[1]
#    = -b[1] - b[2]*b[3] + b[2]^2 + E1^2 - b[2]*E1
#    = -b[1] + b[2]*b[3] + 2*b[2]^2 + b[3]^2 - b[2]*E1
#    = -b[1] + b[2]^2 + b[3]^2;
# E3 = E1*(P[1]+P[2]+P[3]) - P[1]*S[1] - P[2]*S[2] - P[3]*S[3] + E3_P3
#    = (b[2] + b[3])*(S1^2+S2^2+S3^2 - b[2]*E1 - 3*b[1]) +
#      - S[1]*(S1^2 - b2*S1 - b1) - S[2]*(S2^2 - b2*S2 - b1) - S[3]*(S3^2 - b2*S3 - b1) + b1*b2 - b1*b3 - R
#    = (b[2] + b[3])*(E1^2 - 2*E2_P3 - b[2]*E1 - 3*b[1]) +
#      - (S[1]^3+S[2]^3+S[3]^3) + b[2]*(E1^2 - 2*E2_P3) + b[1]*E1   + b[1]*b[2] - b[1]*b[3] - R
#    = (b[2] + b[3])*(2*b[2]^2 + b[3]^2 + b[1] - b[2]*b[3]) +
#      - (E1^3 - 3*E1*E2_P3 + 3*E3_P3) + b[2]*(E1^2 - 2*E2_P3) + b[1]*E1   + b[1]*b[2] - b[1]*b[3] - R
#    = (b[2] + b[3])*(-2*b[2]^2 - 5*b[1]) + # + 3*E2_P3
#      - 3*E3_P3 + b[2]*(E1^2 - 2*E2_P3) + b[1]*E1   + b[1]*b[2] - b[1]*b[3] - R
#    = (b[2] + b[3])*(-2*b[2]^2 - 4*b[1] + b[2]*E1) - 2*b[2]*E2_P3 - 2*b[1]*b[2] + 2*b[1]*b[3] + 2*R
#    = (b[2] + b[3])*(b[2]^2 - 4*b[1] + b[2]*b[3]) - 2*b[2]*E2_P3 - 2*b[1]*b[2] + 2*b[1]*b[3] + 2*R
#    = b[2]*(3*b[2]^2 - b[2]*b[3]) + b[3]*(b[2]^2 - 4*b[1] + b[2]*b[3]) - 2*b[1]*b[2] + 2*b[1]*b[3] + 2*R
#    = 3*b[2]^3 + b[2]*b[3]^2 - 2*b[1]*b[2] - 2*b[1]*b[3] + 2*R

# E6 = (S1^2 - b[2]*S1 - b[1])*(S2^2 - b[2]*S2 - b[1])*(S3^2 - b[2]*S3 - b[1])
#    = - b[2]*E3_P3*(S1*S2 + S1*S3 + S2*S3) + b[2]^2*E3_P3*(S1+S2+S3) - b[2]^3*E3_P3 + E3_P3^2 - b[1]*b[2]^2*(S1*S2 + S1*S3 + S2*S3) +
#      + b[1]*b[2]*(S1^2*S2 + S1^2*S3 + S1*S2^2 + S2^2*S3 + S1*S3^2 + S2*S3^2) - b[1]^2*b[2]*(S1+S2+S3) +
#      - b[1]*(S1^2*S2^2 + S1^2*S3^2 + S2^2*S3^2) + b[1]^2*(S1^2 + S2^2 + S3^2) - b[1]^3
#    = - b[2]*E3_P3*E2_P3 + b[2]^2*E3_P3*E1 - b[2]^3*E3_P3 + E3_P3^2 - b[1]*b[2]^2*E2_P3 +
#      + b[1]*b[2]*(E1*E2_P3 - 3*E3_P3) - b[1]^2*b[2]*E1 +
#      - b[1]*(E2_P3^2 - 2*E3_P3*E1) + b[1]^2*(E1^2 - 2*E2_P3) - b[1]^3
#    = - b[2]*E3_P3*E2_P3 + b[2]^2*E3_P3*(b[2] + b[3]) - b[2]^3*E3_P3 + E3_P3^2 - b[1]*b[2]^2*E2_P3 +
#      + b[1]*b[2]*((b[2] + b[3])*E2_P3 - 3*E3_P3) - b[1]^2*b[2]*(b[2] + b[3]) +
#      - b[1]*(E2_P3^2 - 2*E3_P3*(b[2] + b[3])) + b[1]^2*((b[2] + b[3])^2 - 2*E2_P3) - b[1]^3
#    = - b[2]*E3_P3*E2_P3 + b[2]^2*b[3]*E3_P3 + E3_P3^2 +
#      + b[1]*b[2]*b[3]*E2_P3 - b[1]*b[2]*E3_P3 +
#      - b[1]*(E2_P3^2 - 2*b[3]*E3_P3) + b[1]^2*(b[3]^2 + b[2]*b[3] - 2*E2_P3) - b[1]^3
#    = E3_P3*(b[1]*b[2] + 2*b[1]*b[3] + b[2]^3 + E3_P3) +
#      - b[1]*b[2]*b[3]*(3*b[1] - b[2]*b[3] + b[2]^2) +
#      - b[1]*(2*b[1] - b[2]*b[3] + b[2]^2)^2 + b[1]^2*b[3]^2 + 2*b[1]^2*b[2]^2 + 3*b[1]^3
#    = - R*(3*b[1]*b[2] + b[2]^3 - R) - b[1]^3

# E5 = S1*P2*P3 + S2*P1*P3 + S3*P1*P2
#    = S1*(S2^2 - b[2]*S2 - b[1])*(S3^2 - b[2]*S3 - b[1]) + S2*(S1^2 - b[2]*S1 - b[1])*(S3^2 - b[2]*S3 - b[1]) +
#      + S3*(S1^2 - b[2]*S1 - b[1])*(S2^2 - b[2]*S2 - b[1])
#    = E3_P3*(S1*S2 + S1*S3 + S2*S3) - 2*E3_P3*b[2]*(S1 + S2 + S3) + 3*b[2]^2*E3_P3 + 2*b[1]*b[2]*(S1*S2 + S1*S3 + S2*S3) +
#      - b[1]*(S1^2*S2 + S1^2*S3 + S1*S2^2 + S2^2*S3 + S1*S3^2 + S2*S3^2) + b[1]^2*(S1 + S2 + S3)
#    = E3_P3*E2_P3 - 2*b[2]*E3_P3*E1 + 3*b[2]^2*E3_P3 + 2*b[1]*b[2]*E2_P3 - b[1]*(E1*E2_P3 - 3*E3_P3) + b[1]^2*E1
#    = (-b[2]*b[3] + b[1])*(b[1]*b[2] - b[1]*b[3] - R) +
#      - b[1]^2*b[2] + 3*b[1]^2*b[3] - b[1]*b[2]^3 + 2*b[1]*b[2]^2*b[3] - b[1]*b[2]*b[3]^2
#    = -b[2]*b[3]*(b[1]*b[2] - b[1]*b[3] - R) + b[1]*(b[1]*b[2] - b[1]*b[3] - R) +
#      - b[1]^2*b[2] + 3*b[1]^2*b[3] - b[1]*b[2]^3 + 2*b[1]*b[2]^2*b[3] - b[1]*b[2]*b[3]^2
#    = (b[2]*b[3] - b[1])*R + 2*b[1]^2*b[3] - b[1]*b[2]^3 + b[1]*b[2]^2*b[3]


# E4 = ...;

(R[1]^2 - 3*R[1]*b[1]*b[2] - R[1]*b[2]^3 - b[1]^3) +
	(R[1]*b[1] - R[1]*b[2]*b[3] - b[1]*b[2]^2*b[3] + b[1]*b[2]^3 - 2*b[1]^2*b[3])*x^1 +
	(R[1]*b[2] + R[1]*b[3] - b[1]*b[2]*b[3] - b[1]*b[3]^2 + b[1]^2 - b[2]^3*b[3] + b[2]^4)*x^2 +
	(- 2*R[1] + 2*b[1]*b[2] + 2*b[1]*b[3] - b[2]*b[3]^2 + 2*b[2]^2*b[3] - b[2]^3)*x^3 +
	(- b[1] + b[2]^2 + b[3]^2)*x^4 +
	- (b[2] + b[3])*x^5 + x^6


###################

###################
### (xy)^2 Term ###
###################

### x^3 + b*(x*y)^2

# x^3 + b1*(x*y)^2 = R
# y^3 + b1*(x*y)^2 = R

### Solution:

m3 = unity(3, all=F)

### Diff =>
# x^3 - y^3 = 0
# y = x*m, where m^3 = 1;
# Case: x != y =>
# separate equations for: m & m^2
b1*x^4*m^2 + x^3 - R # = 0
b1*x^4*m + x^3 - R # = 0


#################
### Extension ###

### x^3 + b2*(x*y)^2 + b1*(x*y)

# x^3 + b2*(x*y)^2 + b1*(x*y) = R
# y^3 + b2*(x*y)^2 + b1*(x*y) = R

### Solution:

m3 = unity(3, all=F)

### Diff =>
# x^3 - y^3 = 0
# y = x*m, where m^3 = 1;
# Case: x != y =>
# separate equations for: m & m^2
b2*m^2*x^4 + x^3 + b1*m^1*x^2 - R # = 0
b2*m^1*x^4 + x^3 + b1*m^2*x^2 - R # = 0

### Classic Polynomial:

b[2]^2*x^8 - b[2]*x^7 - (b[1]*b[2] - 1)*x^6 - b[1]*x^5 + (b[1]^2 + b[2]*R)*x^4 - 2*R*x^3 + b[1]*R*x^2 + R^2


#############################
#############################

#######################
### Base: x^n       ###
### + x^j*y^k Terms ###
#######################

### x^3 + b3*x^2*y + b2*x*y^2 + b1*x

# x^3 + b3*x^2*y + b2*x*y^2 + b1*x = R
# y^3 + b3*y^2*x + b2*y*x^2 + b1*y = R

### Solution:

### Diff =>
# x^3 - y^3 + (b3 - b2)*x*y*(x-y) + b1*(x-y) = 0
# (x-y)*(x^2 + y^2 + x*y + (b3 - b2)*x*y + b1) = 0
# Case: x != y =>
x^2 + y^2 + x*y + (b3 - b2)*x*y + b1 # = 0
(x+y)^2 + (b3 - b2 - 1)*x*y + b1
Z^2 + (b3 - b2 - 1)*x*y + b1
# (b3 - b2 - 1)*x*y = - Z^2 - b1
# (b2 - b3 + 1)*x*y = Z^2 + b1 

### Sum =>
x^3 + y^3 + (b3 + b2)*x*y*(x+y) + b1*(x+y) - 2*R # = 0
Z^3 - 3*x*y*Z + (b2 + b3)*x*y*Z + b1*Z - 2*R # = 0
Z^3 + b1*Z - 2*R + (b2 + b3 - 3)*x*y*Z # = 0
Z^3 + b1*Z - 2*R + (b2 + b3 - 3)*Z*(Z^2 + b1)/(b2 - b3 + 1)
(b2 - b3 + 1)*(Z^3 + b1*Z - 2*R) + (b2 + b3 - 3)*Z*(Z^2 + b1)
2*(b2 - 1)*Z^3 + 2*b1*Z*(b2 - 1) - 2*R*(b2 - b3 + 1)
(b2 - 1)*Z^3 + b1*Z*(b2 - 1) - R*(b2 - b3 + 1)

### TODO:
# Case: b2 - b3 + 1 == 0; TODO: verify;
# Case: b2 == 1;
